<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="site-title">AXA</title>
    <link rel="icon" type="image/png" href="media/logos/axa2.png" id="site-favicon">
    <!-- QR Code Styling library for dynamic QR generation -->
    <script src="https://unpkg.com/qr-code-styling@1.9.2/lib/qr-code-styling.js"></script>
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <style>
        @font-face {
            font-family: 'Orbitron';
            src: url('media/fonts/Orbitron/Orbitron-VariableFont_wght.ttf') format('truetype');
            font-weight: 100 900;
            font-style: normal;
        }

        :root {
            /* Font Size Variables - Will be overridden by JavaScript from general.json */
            --font-nav-links: 0.9rem;
            --font-back-button: 0.9rem;
            --font-back-button-icon: 1.2rem;
            --font-hero-title: 2.53rem;
            --font-hero-description: 1.265rem;
            --font-about-title: 3rem;
            --font-about-tagline: 0.75rem;
            --font-about-subtitle: 1.8rem;
            --font-about-content: 1.1rem;
            --font-mission-title: clamp(3rem, 8vw, 6.8rem);
            --font-mission-subtitle: 1.5rem;
            --font-mission-cta: 3rem;
            --font-mission-mobile-title: 3.5rem;
            --font-mission-mobile-subtitle: 1.2rem;
            --font-mission-mobile-cta: 1rem;
            --font-sponsors-title: 2.2rem;
            --font-contact-title: 2.6rem;
            --font-contact-subtitle: 1rem;
            --font-form-label: 0.85rem;
            --font-form-input: 1rem;
            --font-footer-section-title: 1.2rem;
            --font-footer-content: 0.9rem;
            --font-mission-detail-header: 4rem;
            --font-mission-detail-description: 1.1rem;
            --font-mission-detail-section-title: 2.5rem;
            --font-team-member-name: 1.2rem;
            --font-team-member-role: 0.95rem;
            --font-support-button: 1.5rem;
            --font-gallery-button: 1.1rem;
            --font-mobile-hero-title: 2rem;
            --font-mobile-hero-description: 1rem;
            --font-mobile-mission-title: 3.5rem;
            --font-mobile-mission-subtitle: 1.2rem;
            --font-mobile-mission-cta: 1rem;
            --font-mobile-slideshow-title: 1.5rem;
            --font-mobile-slideshow-description: 0.9rem;
            --font-mobile-mission-detail-title: 2.5rem;
            --font-lightbox-close: 4rem;
            --font-qr-description: 1rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            overflow-x: hidden;
            width: 100%;
            position: relative;
        }
        
        body {
            font-family: 'Orbitron', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: hidden;
            width: 100%;
            position: relative;
            max-width: 100vw;
        }

        /* Use Arial for all non-heading text */
        p, a, span, li, .about-tagline, 
        .slideshow-overlay p,
        .about-section p,
        .nav-links a, 
        .footer-section p, 
        .footer-section a {
            font-family: Arial, sans-serif;
        }

        /* Keep Orbitron for headings and titles */
        h1, h2, h3, h4, h5, h6, .mission-title, .slideshow-overlay h1,
        .footer-bottom p, 
        .footer-bottom a {
            font-family: 'Orbitron', sans-serif;
        }

        /* Boot Video Container */
        #boot-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: #000;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease;
        }

        #boot-container.hidden {
            opacity: 0;
            pointer-events: none;
        }

        #boot-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Black Background Box */
        #white-box {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: #000000;
            z-index: 10000;
            display: none;
            pointer-events: none;
        }

        #white-box.visible {
            display: block;
        }

        #white-box.slide-up {
            transform: translateY(-100%);
            transition: transform 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        #logo-center {
            position: fixed;
            width: min(90vw, 1200px);
            height: auto;
            opacity: 0;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            transition: opacity 0.8s ease-out, transform 1.8s cubic-bezier(0.25, 0.46, 0.45, 0.94), width 1.8s cubic-bezier(0.25, 0.46, 0.45, 0.94), top 1.8s cubic-bezier(0.25, 0.46, 0.45, 0.94), left 1.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 10500;
            max-height: 80vh;
            object-fit: contain;
            will-change: transform, opacity, width, top, left;
        }

        #logo-center.fade-in {
            opacity: 1;
        }

        #logo-center.move-to-navbar {
            top: 45px;
            left: 30px;
            width: 180px;
            transform: translate(0, 0);
        }

        /* Main Website */
        #main-website {
            position: relative;
            min-height: 100vh;
            opacity: 0;
            transition: opacity 0.8s ease-out;
            padding-top: 110px;
        }

        #main-website.visible {
            opacity: 1;
        }

        /* Navbar */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(0, 0, 0, 1);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            padding: 50px 30px;
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        /* Desktop Navbar Styles */
        @media (min-width: 769px) {
            .nav-links {
                display: flex;
                gap: 34px;
                list-style: none;
                align-items: center;
            }

            .mobile-socials {
                display: none;
            }
        }

        .nav-links a {
            text-decoration: none;
            color: #ffffff;
            font-weight: 600;
            transition: color 0.3s ease;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            font-size: var(--font-nav-links);
        }

        .nav-links a:hover {
            color: #6666ff;
        }

        .nav-item { position: relative; }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background: rgba(0,0,0,0.98);
            border-radius: 8px;
            padding: 8px 0;
            display: none;
            min-width: 180px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.45);
        }

        .dropdown-menu a {
            display: block;
            padding: 10px 16px;
            color: #ffffff;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: var(--font-nav-links);
            white-space: nowrap;
        }

        .dropdown-menu a:hover { color: #6666ff; }

        .nav-item:hover .dropdown-menu { display: block; }

        /* Navbar Social Icons */
        .nav-socials {
            display: flex;
            gap: 28px;
            align-items: center;
        }

        .nav-socials a {
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .nav-socials img {
            width: 34px;
            height: 34px;
            object-fit: contain;
            opacity: 0.9;
            transition: opacity 0.2s ease, transform 0.2s ease;
        }

        .nav-socials img:hover {
            opacity: 1;
            transform: scale(1.18);
        }

        /* Global Back Button */
        .global-back-btn {
            font-family: 'Orbitron', sans-serif;
            background: transparent;
            color: white;
            border: 2px solid white;
            padding: 8px 20px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: var(--font-back-button);
            transition: all 0.3s ease;
            margin-left: 20px;
        }

        .global-back-btn:hover {
            background: white;
            color: black;
        }

        .global-back-btn span {
            font-size: var(--font-back-button-icon);
            line-height: 1;
        }

        @media (max-width: 768px) {
            .global-back-btn {
                display: none;
            }
        }

        /* Logo and Back Button Container */
        .logo-nav-container {
            display: flex;
            align-items: center;
            min-width: 300px;
        }

        /* Slideshow Section */
        .slideshow-container {
            position: relative;
            width: 100%;
            height: 85vh;
            margin-top: 0;
            overflow: hidden;
        }

        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
        }

        .slide.active {
            opacity: 1;
        }

        .slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        /* Slideshow Overlay Text */
        .slideshow-overlay {
            position: absolute;
            bottom: 80px;
            left: 80px;
            background: rgba(0, 0, 0, 0.65);
            color: white;
            padding: 46px 58px;
            border-radius: 17px;
            text-align: left;
            max-width: 690px;
            z-index: 10;
            backdrop-filter: blur(5px);
        }

        .slideshow-overlay h1 {
            font-size: var(--font-hero-title);
            margin-bottom: 23px;
            font-weight: 700;
            line-height: 1.3;
        }

        .slideshow-overlay p {
            font-size: var(--font-hero-description);
            line-height: 1.7;
            font-weight: 300;
        }

        /* About Section */
        .about-section {
            background: #ffffff;
            padding: 40px 40px;
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .about-section::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100vw; /* full viewport width */
            height: 3px; /* consistent thickness */
            background: #cccccc;
        }

        .about-content {
            max-width: 600px;
        }

        .about-section h2 {
            font-size: var(--font-about-title);
            font-weight: 700;
            color: #00008f;
            margin-bottom: 15px;
        }

        .about-tagline {
            font-size: var(--font-about-tagline);
            line-height: 1.5;
            color: #333;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .about-section h3 {
            font-size: var(--font-about-subtitle);
            font-weight: 700;
            color: #00008f;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .about-section p {
            font-size: var(--font-about-content);
            line-height: 1.8;
            color: #555;
        }

        /* Solar System Animation */
        .solar-system {
            position: relative;
            width: 600px;
            height: 800px;
            margin: 0 auto;
            overflow: hidden;
            contain: strict;
        }

        .sun {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70px;
            height: 70px;
            background: radial-gradient(circle, #FDB813, #FF6B00);
            border-radius: 50%;
            box-shadow: 0 0 40px rgba(253, 184, 19, 0.8);
            z-index: 10;
        }

        .orbit {
            position: absolute;
            top: 50%;
            left: 50%;
            border: 1px solid rgba(0, 0, 143, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        .planet {
            position: absolute;
            border-radius: 50%;
            top: 0;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* Mercury */
        .orbit-1 {
            width: 120px;
            height: 120px;
            animation: rotate 3s linear infinite;
        }
        .planet-1 {
            width: 10px;
            height: 10px;
            background: linear-gradient(135deg, #A89968, #6B5D44);
        }

        /* Venus */
        .orbit-2 {
            width: 168px;
            height: 168px;
            animation: rotate 5s linear infinite;
        }
        .planet-2 {
            width: 14px;
            height: 14px;
            background: linear-gradient(135deg, #FFD966, #E8B84D);
        }

        /* Earth */
        .orbit-3 {
            width: 228px;
            height: 228px;
            animation: rotate 8s linear infinite;
        }
        .planet-3 {
            width: 16px;
            height: 16px;
            background: linear-gradient(135deg, #2E86AB, #A23B72);
        }

        /* Mars */
        .orbit-4 {
            width: 288px;
            height: 288px;
            animation: rotate 12s linear infinite;
        }
        .planet-4 {
            width: 12px;
            height: 12px;
            background: linear-gradient(135deg, #E27B58, #CD5C5C);
        }

        /* Jupiter */
        .orbit-5 {
            width: 384px;
            height: 384px;
            animation: rotate 18s linear infinite;
        }
        .planet-5 {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #C88B3A, #A67C52);
        }

        /* Saturn */
        .orbit-6 {
            width: 480px;
            height: 480px;
            animation: rotate 25s linear infinite;
        }
        .planet-6 {
            width: 26px;
            height: 26px;
            background: linear-gradient(135deg, #FAD5A5, #E6BE8A);
            position: relative;
        }

        .saturn-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 45px;
            height: 45px;
            border: 3px solid rgba(160, 130, 95, 0.8);
            border-radius: 50%;
            box-shadow: inset 0 0 5px rgba(120, 100, 75, 0.6);
        }

        /* Uranus */
        .orbit-7 {
            width: 520px;
            height: 520px;
            animation: rotate 28s linear infinite;
        }
        .planet-7 {
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #4FD1C5, #2C7A7B);
            position: relative;
        }

        .uranus-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 35px;
            height: 35px;
            border: 2px solid rgba(79, 209, 197, 0.5);
            border-radius: 50%;
        }

        /* Neptune */
        .orbit-8 {
            width: 560px;
            height: 560px;
            animation: rotate 32s linear infinite;
        }
        .planet-8 {
            width: 18px;
            height: 18px;
            background: linear-gradient(135deg, #4169E1, #1E3A8A);
        }

        @keyframes rotate {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }

        /* Mission Blocks */
        .missions-container {
            display: flex;
            flex-direction: column;
            gap: 0;
            width: 100vw;
            margin: 0;
            padding: 0;
            position: relative;
            left: 50%;
            right: 50%;
            margin-left: -50vw;
            margin-right: -50vw;
            max-width: none;
            box-sizing: border-box;
        }

        .mission-block {
            position: relative;
            height: 400px; /* reduced ~20% from 525px */
            width: 100%;
            overflow: hidden;
            cursor: pointer;
            border-top: 3px solid #cccccc; /* consistent divider */
            display: block;
            margin: 0;
            padding: 0;
        }

        /* Remove extra top border before the first mission to avoid double line after About */
        .missions-container .mission-block:first-child {
            border-top: none;
        }

        .mission-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('media/placeholder.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: scroll;
            transition: transform 0.5s ease;
            z-index: 1;
        }

        .mission-background::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0);
            transition: background 0.3s ease;
            pointer-events: none;
            z-index: 1;
        }

        .mission-block:hover .mission-background {
            transform: scale(1.1);
        }

        .mission-block:hover .mission-background::after {
            background: rgba(0, 0, 0, 0.3);
        }

        .mission-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            clip-path: polygon(0 0, 0 100%, 38% 100%, 45% 0);
            display: flex;
            align-items: center;
            padding: 80px;
            z-index: 2;
        }

        .mission-title {
            font-size: var(--font-mission-title);
            font-weight: 700;
            color: black;
            text-align: left;
            position: relative;
            z-index: 1;
            margin-bottom: 10px;
        }

        .mission-subtitle {
            font-family: 'Orbitron', sans-serif;
            font-size: var(--font-mission-subtitle);
            font-weight: 400;
            color: #333;
            text-align: left;
            position: relative;
            z-index: 1;
        }

        .mission-cta {
            position: absolute;
            top: 50%;
            right: 17%;
            transform: translateY(-50%);
            font-family: 'Orbitron', sans-serif;
            font-size: var(--font-mission-cta);
            font-weight: 500;
            color: white;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 10;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .mission-block:hover .mission-cta {
            opacity: 1;
        }

        /* Footer */
        footer {
            background: #000000;
            color: white;
            padding: 60px 30px 20px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto 40px;
        }

        .footer-section h3 {
            font-size: var(--font-footer-section-title);
            margin-bottom: 15px;
            color: #ffffff;
        }

        .footer-section p {
            margin-bottom: 10px;
            color: #cccccc;
            line-height: 1.6;
        }

        .footer-section a {
            color: #cccccc;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-section a:hover {
            color: #ffffff;
        }

        /* Footer Social Icons */
        .footer-socials {
            display: flex;
            gap: 18px;
            align-items: center;
            margin-top: 8px;
        }

        .footer-socials a {
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .footer-socials img {
            width: 30px;
            height: 30px;
            object-fit: contain;
            opacity: 0.9;
            transition: opacity 0.2s ease, transform 0.2s ease;
        }

        .footer-socials img:hover {
            opacity: 1;
            transform: scale(1.05);
        }

        /* About section: render social icons as black (invert white icons) */
        .about-section .footer-socials {
            justify-content: center;
            gap: 36px; /* doubled from base 18px */
        }

        .about-section .footer-socials img {
            filter: invert(1) brightness(0) contrast(100%);
            transform: scale(1.5);
        }

        .about-section .footer-socials img:hover {
            transform: scale(1.7);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            border-top: 3px solid #cccccc; /* consistent divider */
            margin-top: 20px;
        }

        .footer-bottom p {
            color: #888;
            font-size: var(--font-footer-content);
            margin: 5px 0;
        }

        .footer-bottom a {
            color: #888;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-bottom a:hover {
            color: #ffffff;
        }

        /* Sponsors Marquee Section */
        .sponsor-section {
            background: #f2f2f2; /* light gray backdrop */
            padding: 90px 30px;
            border-top: 3px solid #cccccc;
            border-bottom: 3px solid #cccccc;
        }

        .sponsor-inner {
            max-width: 1800px; /* wider cutoff viewport */
            margin: 0 auto;
        }

        .sponsor-title {
            font-family: 'Orbitron', sans-serif;
            font-size: var(--font-sponsors-title);
            color: #00008f; /* dark blue used elsewhere */
            text-align: center;
            font-weight: 700; /* bold */
        }

        .sponsor-marquee {
            position: relative;
            overflow: hidden;
            width: 100%;
            margin-top: 35px;
            background: #fafafa; /* slightly brighter than backdrop */
            border: 1px solid #e6e6e6;
            border-radius: 14px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.05);
            padding: 18px 8px;
        }

        .sponsor-track {
            display: flex;
            will-change: transform;
        }

        .sponsor-strip {
            display: flex;
            gap: 70px;
            flex-shrink: 0;
            padding: 0 35px;
        }

        .sponsor-item {
            flex: 0 0 auto;
            width: 280px; /* bigger cards */
            height: 150px; /* taller cards */
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f7f7f7;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        }

        .sponsor-item img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }

        /* marquee handled via JS for perfect seamless loop */

        /* Sponsor Actions */
        .sponsor-actions {
            text-align: center;
            margin-top: 30px;
        }

        .sponsor-support-btn {
            background: #00008f;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sponsor-support-btn:hover {
            background: #000066;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 143, 0.3);
        }

        /* About Actions */
        .about-actions {
            display: flex;
            gap: 15px;
            margin: 25px 0;
            justify-content: center;
        }

        .about-join-btn,
        .about-sponsor-btn {
            padding: 12px 24px;
            border: 2px solid #00008f;
            border-radius: 8px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .about-join-btn {
            background: transparent;
            color: #00008f;
        }

        .about-join-btn:hover {
            background: #00008f;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 143, 0.2);
        }

        .about-sponsor-btn {
            background: #00008f;
            color: white;
        }

        .about-sponsor-btn:hover {
            background: #000066;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 143, 0.3);
        }

        /* Calendar Section */
        .calendar-section {
            background: #f8f9fa;
            padding: 80px 30px;
            border-top: 3px solid #cccccc;
        }

        .calendar-inner {
            max-width: 1200px;
            margin: 0 auto;
        }

        .calendar-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .calendar-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            color: #00008f;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .calendar-subtitle {
            font-size: 1.1rem;
            color: #666;
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Interactive Calendar Widget */
        .calendar-widget {
            background: #ffffff;
            border: 1px solid #e6e6e6;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .calendar-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e6e6e6;
        }

        .calendar-nav-btn {
            background: #00008f;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .calendar-nav-btn:hover {
            background: #000066;
            transform: scale(1.1);
        }

        .calendar-month-year {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: #00008f;
        }

        .calendar-grid {
            width: 100%;
        }

        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }

        .calendar-weekday {
            text-align: center;
            padding: 10px 5px;
            font-weight: 600;
            color: #666;
            font-size: 0.9rem;
            font-family: 'Orbitron', sans-serif;
            border: 1px solid #e0e0e0;
            background: #f5f5f5;
        }

        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: visible;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: flex-start;
            justify-content: flex-start;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s ease;
            position: relative;
            font-size: 0.9rem;
            font-weight: 500;
            min-height: 40px;
            padding: 4px;
            border: 1px solid #e0e0e0;
            background: #fafafa;
            z-index: 1;
            overflow: visible;
        }

        .calendar-day:hover {
            background: #f0f0f0;
            z-index: 10;
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border-color: #00008f;
        }

        .calendar-day.other-month {
            color: #ccc;
        }

        .calendar-day.today {
            background: #00008f;
            color: white;
            font-weight: bold;
        }

        .calendar-day.has-event {
            background: linear-gradient(135deg, #e8f4fd, #d1e7f7);
            border: 2px solid #00008f;
            font-weight: bold;
            color: #00008f;
            box-shadow: 0 2px 8px rgba(0, 0, 143, 0.2);
        }

        .calendar-day.has-event:hover {
            background: linear-gradient(135deg, #d1e7f7, #b8d4f0);
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 143, 0.3);
        }

        .calendar-day.has-event.today {
            background: linear-gradient(135deg, #00008f, #000066);
            color: white;
            border-color: #00008f;
        }

        /* Multiple events styling */
        .calendar-day.has-event {
            min-height: 140px;
        }

        .calendar-day.has-event:hover {
            min-height: 160px;
        }

        .event-indicator {
            position: absolute;
            bottom: 2px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #00008f;
        }

        .event-indicator.mission { background: #28a745; }
        .event-indicator.meeting { background: #17a2b8; }
        .event-indicator.presentation { background: #ffc107; }
        .event-indicator.testing { background: #dc3545; }
        .event-indicator.planning { background: #6f42c1; }

        .calendar-day .event-title {
            position: absolute;
            left: 4px;
            right: 4px;
            font-size: 10px;
            font-weight: 400;
            color: #00008f;
            text-align: center;
            white-space: normal;
            word-wrap: break-word;
            line-height: 1.0;
            background: rgba(255, 255, 255, 0.95);
            padding: 3px 4px;
            border-radius: 3px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);
            min-height: 30px;
            max-height: 35px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            z-index: 2;
        }

        /* Force larger event titles with higher specificity */
        .calendar-widget .calendar-day .event-title {
            font-size: 12px;
            line-height: 1.0;
            min-height: 30px;
            max-height: 35px;
            padding: 3px 4px;
        }

        /* Event Popup Styles */
        .event-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }

        .event-popup.active {
            display: flex;
        }

        .event-popup-content {
            background: #ffffff;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            animation: popupSlideIn 0.3s ease-out;
        }

        .event-popup-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            transition: color 0.3s ease;
        }

        .event-popup-close:hover {
            color: #000;
        }

        .event-popup-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .event-popup-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: #00008f;
            margin: 0;
            flex: 1;
            margin-right: 15px;
        }

        .event-popup-type {
            background: #00008f;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
        }

        .event-popup-type.mission { background: #28a745; }
        .event-popup-type.meeting { background: #17a2b8; }
        .event-popup-type.presentation { background: #ffc107; color: #000; }
        .event-popup-type.testing { background: #dc3545; }
        .event-popup-type.planning { background: #6f42c1; }

        .event-popup-details {
            margin-bottom: 20px;
        }

        .event-popup-date,
        .event-popup-time,
        .event-popup-location {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-size: 1rem;
            color: #555;
            font-weight: 500;
        }

        .event-popup-description {
            font-size: 1rem;
            line-height: 1.6;
            color: #666;
            font-family: Arial, sans-serif;
        }

        .calendar-events {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        .calendar-event {
            background: #ffffff;
            border: 1px solid #e6e6e6;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .calendar-event:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .calendar-event::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: #00008f;
        }

        .event-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .event-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            color: #00008f;
            margin: 0;
            flex: 1;
            margin-right: 15px;
        }

        .event-type {
            background: #00008f;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
        }

        .event-type.mission { background: #28a745; }
        .event-type.meeting { background: #17a2b8; }
        .event-type.presentation { background: #ffc107; color: #000; }
        .event-type.testing { background: #dc3545; }
        .event-type.planning { background: #6f42c1; }

        .event-details {
            margin-bottom: 15px;
        }

        .event-date-time {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 0.95rem;
            color: #555;
        }

        .event-date-time::before {
            content: '📅';
            margin-right: 8px;
        }

        .event-location {
            display: flex;
            align-items: center;
            font-size: 0.95rem;
            color: #555;
        }

        .event-location::before {
            content: '📍';
            margin-right: 8px;
        }

        .event-description {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.5;
            font-family: Arial, sans-serif;
        }

        .event-status {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #28a745;
        }

        .event-status.upcoming { background: #28a745; }
        .event-status.ongoing { background: #ffc107; }
        .event-status.completed { background: #6c757d; }

        /* Calendar Empty State */
        .calendar-empty {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .calendar-empty h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #00008f;
        }

        .calendar-empty p {
            font-size: 1rem;
            line-height: 1.6;
        }

        /* Contact Section */
        .contact-section {
            background: #ffffff;
            padding: 100px 30px;
        }

        .contact-inner {
            max-width: 900px;
            margin: 0 auto;
        }

        .contact-title {
            font-family: 'Orbitron', sans-serif;
            font-size: var(--font-contact-title);
            color: #00008f;
            text-align: center;
            font-weight: 700;
            margin-bottom: 30px;
        }

        .contact-subtext {
            text-align: center;
            color: #555;
            margin-bottom: 40px;
            font-size: var(--font-contact-subtitle);
            font-family: Arial, sans-serif;
        }

        .contact-form {
            background: #fafafa;
            border: 1px solid #e6e6e6;
            border-radius: 12px;
            padding: 28px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.05);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 18px 24px;
        }

        .form-row {
            display: flex;
            flex-direction: column;
        }

        .form-row label {
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: var(--font-form-label);
            color: #00008f;
            margin-bottom: 8px;
        }

        .form-row input,
        .form-row select,
        .form-row textarea {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 12px 14px;
            font-size: var(--font-form-input);
            font-family: Arial, sans-serif;
            outline: none;
        }

        .form-row textarea {
            min-height: 140px;
            resize: vertical;
        }

        .form-actions {
            margin-top: 22px;
            text-align: right;
        }

        .btn-primary {
            padding: 14px 30px;
            background: #00008f;
            color: #ffffff;
            border: none;
            border-radius: 8px;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            cursor: pointer;
            transition: background 0.2s ease, transform 0.2s ease;
        }

        .btn-primary:hover {
            background: #000066;
            transform: translateY(-1px);
        }

        .btn-primary:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }

        /* Confetti Popup Styles */
        .confetti-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }

        .confetti-popup.active {
            display: flex;
        }

        .confetti-content {
            background: #ffffff;
            color: #333333;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            position: relative;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            animation: popupSlideIn 0.5s ease-out;
            border: 2px solid #00008f;
        }

        @keyframes popupSlideIn {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(-50px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .confetti-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: bounce 1s ease-in-out;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-20px);
            }
            60% {
                transform: translateY(-10px);
            }
        }

        .confetti-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: #00008f;
        }

        .confetti-message {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 25px;
            opacity: 0.95;
        }

        .confetti-close {
            background: #00008f;
            border: 2px solid #00008f;
            color: white;
            padding: 12px 30px;
            border-radius: 25px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .confetti-close:hover {
            background: #6666ff;
            border-color: #6666ff;
            transform: translateY(-2px);
        }

        /* Confetti Animation */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ff6b6b;
            animation: confetti-fall 3s linear infinite;
        }

        .confetti:nth-child(odd) {
            background: #4ecdc4;
            animation-delay: -0.5s;
        }

        .confetti:nth-child(even) {
            background: #45b7d1;
            animation-delay: -1s;
        }

        .confetti:nth-child(3n) {
            background: #f9ca24;
            animation-delay: -1.5s;
        }

        .confetti:nth-child(4n) {
            background: #6c5ce7;
            animation-delay: -2s;
        }

        .confetti:nth-child(5n) {
            background: #a29bfe;
            animation-delay: -2.5s;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Mobile and Tablet Responsive Styles */
        @media (max-width: 1024px) {
            .about-section {
                grid-template-columns: 1fr;
                padding: 30px 20px;
                gap: 30px;
            }

            .solar-system {
                display: none;  /* Hide on mobile */
            }

            .about-content {
                max-width: 100%;
                text-align: center;
            }

            .about-section {
                padding: 50px 30px;
                contain: content;
                min-height: min-content;
            }

            /* Scale down planet sizes and orbits for mobile */
            .sun {
                width: 40px;
                height: 40px;
            }

            .orbit-1 { width: 100px; height: 100px; }
            .orbit-2 { width: 140px; height: 140px; }
            .orbit-3 { width: 180px; height: 180px; }
            .orbit-4 { width: 220px; height: 220px; }
            .orbit-5 { width: 280px; height: 280px; }
            .orbit-6 { width: 340px; height: 340px; }
            .orbit-7 { width: 400px; height: 400px; }
            .orbit-8 { width: 460px; height: 460px; }

            .mission-block {
                height: 300px;
            }

            .mission-overlay {
                clip-path: polygon(0 0, 0 100%, 55% 100%, 60% 0);
                padding: 40px;
            }

            .mission-cta {
                right: 10%;
                font-size: 2rem;
            }

            .slideshow-overlay {
                left: 50%;
                transform: translateX(-50%);
                bottom: 40px;
                padding: 30px;
                width: 90%;
                max-width: 600px;
            }

            .slideshow-overlay h1 {
                font-size: var(--font-mobile-hero-title);
            }

            .slideshow-overlay p {
                font-size: var(--font-mobile-hero-description);
            }
        }

        @media (max-width: 768px) {
            .navbar {
                padding: 15px 20px;
                height: 70px;
            }
            
            #main-website {
                padding-top: 0;
            }

            .nav-links {
                display: none;
            }

            .nav-socials {
                display: flex;
                margin-left: auto;
                gap: 20px;
            }

            .nav-socials img {
                width: 28px;
                height: 28px;
            }

            #logo-center.move-to-navbar {
                width: 140px;
                top: 20px;
            }

            .mission-block {
                height: 250px;
            }

            .mission-overlay {
                clip-path: none;
                background: transparent;
                padding: 0;
                display: flex;
                justify-content: center;
                align-items: center;
                text-align: center;
                z-index: 10;
                width: 100%;
                position: relative;
            }

            .mission-block {
                position: relative;
                overflow: hidden;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .mission-title {
                color: white;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.9);
                font-size: var(--font-mobile-mission-title);
            }

            .mission-subtitle {
                color: white;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.9);
            }

            .mission-background {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 1;
            }

            .mission-background::after {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                z-index: 2;
            }

            .mission-mobile-title {
                position: relative;
                z-index: 10;
                text-align: center;
                padding: 20px;
                width: 100%;
            }

            .mission-mobile-title h2 {
                font-size: var(--font-mobile-mission-title);
                font-weight: 800;
                margin-bottom: 15px;
                font-family: 'Orbitron', sans-serif;
                color: white;
                text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.9);
            }

            .mission-mobile-title p {
                font-size: var(--font-mobile-mission-subtitle);
                margin-bottom: 20px;
                color: white;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.9);
                font-weight: 500;
            }

            .mission-mobile-title .mobile-cta {
                display: inline-block;
                font-size: var(--font-mobile-mission-cta);
                text-transform: uppercase;
                letter-spacing: 0.1em;
                color: white;
                background: rgba(0, 0, 0, 0.5);
                padding: 10px 20px;
                border-radius: 4px;
                border: 1px solid rgba(255, 255, 255, 0.6);
                margin-top: 10px;
            }

            .sponsor-item {
                width: 200px;
                height: 120px;
            }

            .about-actions {
                flex-direction: column;
                gap: 12px;
                align-items: center;
            }

            .about-join-btn,
            .about-sponsor-btn {
                width: 100%;
                max-width: 200px;
            }

            .contact-section {
                padding: 60px 20px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .footer-content {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .footer-socials {
                justify-content: center;
            }

            .confetti-content {
                padding: 30px 20px;
                margin: 20px;
            }

            .confetti-title {
                font-size: 1.5rem;
            }

            .confetti-message {
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            #main-website,
            #mission-detail-page,
            .about-section,
            .mission-block,
            .sponsor-section,
            .contact-section,
            footer {
                max-width: 100vw;
                overflow-x: hidden;
            }
            .slideshow-container {
                height: 70vh;
                margin-top: 70px;  /* Match navbar height exactly */
            }

            .slideshow-overlay {
                padding: 20px;
                bottom: 20px;
            }

            .slideshow-overlay h1 {
                font-size: var(--font-mobile-slideshow-title);
                margin-bottom: 15px;
            }

            .slideshow-overlay p {
                font-size: var(--font-mobile-slideshow-description);
            }

            .mission-block {
                height: 200px;
            }

            .mission-overlay {
                padding: 20px;
                width: 100%;
            }

            .mission-subtitle {
                font-size: var(--font-mobile-mission-cta);
            }

            .mission-cta {
                font-size: var(--font-mobile-slideshow-title);
            }

            .sponsor-item {
                width: 160px;
                height: 100px;
            }

            .sponsor-support-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }

            .calendar-section {
                padding: 60px 20px;
            }

            .calendar-title {
                font-size: 2rem;
            }

            .calendar-events {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .calendar-event {
                padding: 20px;
            }

            .event-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .event-title {
                margin-right: 0;
                margin-bottom: 10px;
            }

            .calendar-widget {
                padding: 15px;
                display: none; /* Hide calendar widget on mobile */
            }

            .calendar-month-year {
                font-size: 1.2rem;
            }

            .calendar-nav-btn {
                width: 35px;
                height: 35px;
                font-size: 16px;
            }

            .calendar-day {
                min-height: 35px;
                font-size: 0.8rem;
            }

            .calendar-weekday {
                padding: 8px 2px;
                font-size: 0.8rem;
            }

            .calendar-day .event-title {
                font-size: 8px !important;
                top: 18px !important;
                padding: 2px 3px !important;
                min-height: 24px !important;
                max-height: 28px !important;
                -webkit-line-clamp: 3 !important;
                line-clamp: 3 !important;
            }

            .qr-button {
                width: 40px;
                height: 40px;
                bottom: 20px;
                right: 20px;
            }

            .grid-pattern {
                width: 16px;
                height: 16px;
            }

            /* Mission Detail Page Mobile Styles */
            .mission-content {
                padding: 40px 20px;
            }

            .back-button {
                left: auto;
                right: 20px;
                padding: 8px 20px;
            }

            .mission-header h1 {
                font-size: var(--font-mobile-mission-detail-title);
            }

            .team-member img {
                width: 150px;
                height: 150px;
            }
        }

        /* Mobile Menu Toggle */
        .menu-toggle {
            display: none;
            flex-direction: column;
            justify-content: space-between;
            width: 30px;
            height: 20px;
            cursor: pointer;
            margin-left: auto;
            margin-right: 20px;
        }

        .menu-toggle span {
            display: block;
            width: 100%;
            height: 2px;
            background: white;
            transition: transform 0.3s ease, opacity 0.3s ease;
            position: relative;
        }

        .menu-toggle.active span:nth-child(1) {
            transform: translateY(8px) rotate(45deg);
        }

        .menu-toggle.active span:nth-child(2) {
            opacity: 0;
        }

        .menu-toggle.active span:nth-child(3) {
            transform: translateY(-8px) rotate(-45deg);
        }

        /* Mobile Mission Block Styles */
        .mission-mobile-title {
            display: none;
            position: absolute;
            color: white;
            z-index: 2;
            text-align: center;
            width: 100%;
        }

        @media (max-width: 768px) {
            .menu-toggle {
                display: flex;
            }

            .nav-links {
                display: flex;
                flex-direction: column;
                position: fixed;
                top: 70px;
                left: 0;
                right: 0;
                background: rgba(0, 0, 0, 0.95);
                padding: 30px 20px;
                gap: 25px;
                transform: translateY(-100%);
                opacity: 0;
                visibility: hidden;
                transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out, visibility 0.5s ease-in-out;
                z-index: 1500;
            }

            .nav-links.active {
                transform: translateY(0);
                opacity: 1;
                visibility: visible;
            }

            .nav-item {
                width: 100%;
                text-align: center;
            }

            .nav-socials {
                display: none;
            }

            .mobile-socials {
                display: none;
            }

            @media (max-width: 768px) {
                .mobile-socials {
                    display: none;
                    justify-content: center;
                    gap: 15px;
                    padding-top: 20px;
                    margin-top: 10px;
                    border-top: 1px solid rgba(255, 255, 255, 0.1);
                }

                .mobile-socials img {
                    width: 20px;
                    height: 20px;
                }

                .nav-links.active .mobile-socials {
                    display: flex;
                }
            }

            .dropdown-menu {
                position: static;
                background: transparent;
                box-shadow: none;
                display: none;
                padding: 10px 0;
            }

            .nav-item:hover .dropdown-menu {
                display: block;
            }
        }

        /* Mission Detail Page */
        #mission-detail-page {
            display: none;
            min-height: 100vh;
            background: white;
            padding-top: 110px;
        }

        #mission-detail-page.active {
            display: block;
        }

        .mission-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 60px 80px 80px;
            position: relative;
        }

        /* Full width sponsor section on mission pages */
        #mission-detail-page .sponsor-section {
            margin-left: calc(-50vw + 50%);
            margin-right: calc(-50vw + 50%);
            width: 100vw;
            max-width: none;
        }

        .back-button {
            position: fixed;
            top: 45px;
            left: 230px;
            background: #ffffff;
            color: #000000;
            border: none;
            padding: 12px 30px;
            font-size: var(--font-form-input);
            font-weight: 600;
            cursor: pointer;
            border-radius: 5px;
            transition: background 0.3s ease, transform 0.3s ease;
            z-index: 1001;
            font-family: 'Orbitron', sans-serif;
        }

        .back-button:hover {
            background: #6666ff;
            color: #ffffff;
            transform: translateX(-5px);
        }

        .mission-header {
            margin-bottom: 60px;
        }

        .mission-header h1 {
            font-size: var(--font-mission-detail-header);
            color: #00008f;
            margin-bottom: 20px;
        }

        .mission-description {
            font-size: var(--font-mission-detail-description);
            line-height: 1.8;
            color: #555;
            margin-bottom: 60px;
            font-family: Arial, sans-serif;
        }

        .mission-section {
            margin-bottom: 80px;
        }

        .mission-section h2 {
            font-size: var(--font-mission-detail-section-title);
            color: #00008f;
            margin-bottom: 40px;
            text-align: center;
        }

        /* Team Section */
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .team-member {
            text-align: center;
        }

        .team-member img {
            width: 200px;
            height: 200px;
            object-fit: cover;
            border-radius: 50%;
            margin-bottom: 15px;
            border: 4px solid #00008f;
        }

        .team-member h3 {
            font-size: var(--font-team-member-name);
            color: #333;
            margin-bottom: 5px;
        }

        .team-member p {
            font-size: var(--font-team-member-role);
            color: #666;
            font-style: italic;
        }

        /* Images Gallery */
        .images-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .gallery-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .gallery-image:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .expand-gallery-btn {
            display: block;
            margin: 0 auto;
            padding: 15px 40px;
            background: #00008f;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: var(--font-gallery-button);
            cursor: pointer;
            transition: background 0.3s ease;
            font-family: 'Orbitron', sans-serif;
        }

        .expand-gallery-btn:hover {
            background: #000066;
        }

        /* Sponsors Section */
        .sponsors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px;
            align-items: center;
            justify-items: center;
        }

        .sponsor-logo {
            max-width: 200px;
            max-height: 100px;
            object-fit: contain;
            filter: grayscale(100%);
            transition: filter 0.3s ease;
        }

        .sponsor-logo:hover {
            filter: grayscale(0%);
        }

        /* Support Button */
        .support-button {
            display: block;
            margin: 60px auto 0;
            padding: 20px 60px;
            background: #00008f;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: var(--font-support-button);
            font-weight: 700;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.3s ease;
            font-family: 'Orbitron', sans-serif;
            text-decoration: none;
        }

        .support-button:hover {
            background: #000066;
            transform: scale(1.05);
        }

        /* Gallery Lightbox */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10002;
            align-items: center;
            justify-content: center;
        }

        .lightbox.active {
            display: flex;
        }

        .lightbox img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }

        .lightbox-close {
            position: absolute;
            top: 30px;
            right: 40px;
            font-size: var(--font-lightbox-close);
            color: white;
            cursor: pointer;
            line-height: 1;
        }

        /* QR Code Button */
        .qr-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #000000;
            border: 2px solid #ffffff;
            cursor: pointer;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: scale(0);
            transition: opacity 0.3s ease, transform 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .qr-button.visible {
            opacity: 1;
            transform: scale(1);
        }

        .grid-pattern {
            width: 20px;
            height: 20px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 2px;
        }

        .grid-pattern div {
            background: #ffffff;
            width: 100%;
            height: 100%;
        }

        /* QR Code Popup */
        .qr-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .qr-popup.active {
            display: flex;
        }

        .qr-popup-content {
            background: #000000;
            padding: 30px;
            border-radius: 15px;
            position: relative;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .qr-close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #ffffff;
        }

        #qr-code {
            margin: 20px 0;
        }

        .qr-popup-content p {
            margin-top: 15px;
            color: #ffffff;
            font-family: 'Orbitron', sans-serif;
            font-size: var(--font-qr-description);
        }
    </style>
</head>
<body>
    <!-- Boot Video Container -->
    <div id="boot-container">
        <video id="boot-video" autoplay muted>
            <source src="media/boot/boot.mp4" type="video/mp4">
        </video>
    </div>

    <!-- White Background Box -->
    <div id="white-box"></div>

    <!-- Center Logo -->
    <img id="logo-center" src="media/logos/logo-white.png" alt="AXA Logo">

    <!-- Navbar -->
    <nav class="navbar">
        <div class="logo-nav-container">
            <div style="width: 180px; cursor: pointer;" onclick="goToHome()"></div>
            <button class="global-back-btn" onclick="goBackToMain()" style="display: none;">
                <span>←</span> BACK
            </button>
        </div>
        <div class="menu-toggle" onclick="toggleMobileMenu()">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <ul class="nav-links">
            <li class="nav-item"><a href="#" onclick="goToHome(); return false;" id="nav-home">Home</a></li>
            <li class="nav-item"><a href="#about" onclick="scrollToAbout(); return false;" id="nav-about">About</a></li>
            <li class="nav-item">
                <a href="#missions" onclick="scrollToMissions(); return false;" id="nav-missions">Missions</a>
                <div class="dropdown-menu">
                    <a href="#missions" onclick="openMission(1); return false;">Mission 1</a>
                    <a href="#missions" onclick="openMission(2); return false;">Mission 2</a>
                    <a href="#missions" onclick="openMission(3); return false;">Mission 3</a>
                </div>
            </li>
            <li class="nav-item"><a href="#" onclick="openWhatsApp(); return false;" id="nav-join">Join</a></li>
            <li class="nav-item"><a href="#contact" onclick="scrollToContact('Sponsorship'); return false;" id="nav-support">Support</a></li>
            <li class="nav-item"><a href="#contact" onclick="scrollToContact(); return false;" id="nav-contact">Contact</a></li>
            <div class="mobile-socials" id="mobile-socials">
                <!-- Dynamic social links will be loaded here -->
            </div>
        </ul>
        <div class="nav-socials" id="nav-socials">
            <!-- Dynamic social links will be loaded here -->
        </div>
    </nav>

    <!-- Main Website -->
    <div id="main-website">
        <!-- Slideshow Section -->
        <div class="slideshow-container">
            <div class="slide active">
                <img src="media/cover/IMG_9040.jpg" alt="AXA Slideshow Image 1">
            </div>
            <div class="slide">
                <img src="media/cover/IMG_9002.jpg" alt="AXA Slideshow Image 2">
            </div>
            <div class="slide">
                <img src="media/cover/DSCF4965.JPG" alt="AXA Slideshow Image 3">
            </div>
            
            <!-- Overlay Text -->
            <div class="slideshow-overlay">
                <h1 id="hero-title">Join Our Mission to Launch a CubeSat into Orbit</h1>
                <p id="hero-description">We are a dedicated aerospace experimental association committed to launching a CubeSat into orbit. Our team of passionate innovators is driven by a shared vision of exploring the cosmos and advancing the frontiers of space technology.</p>
            </div>
        </div>

        <!-- About Section -->
        <section class="about-section" id="about">
            <div class="about-content">
                <h2 id="about-title">About</h2>
                <p id="about-content">
                    As humanity ventures away from Earth to the Moon and Mars, feeding our astronauts becomes essential. Our current method of supplying food—launching it on demand—is costly and lacks the necessary nutrients for long-term travel. Growing plants in space is the logical next step for rapid local food production. This feat will prove challenging as we navigate issues like microgravity, with its lack of convection and plant growth directionality, and cosmic radiation damaging cell DNA and increasing mutation. Space plant farming on the ISS is limited and requires human interaction. Developing an autonomous CubeSat payload for plant farming research is the next step toward colonizing space.
                </p>
                <div class="about-actions">
                    <button class="about-join-btn" id="about-join-btn" onclick="openWhatsApp(); return false;">Join</button>
                    <button class="about-sponsor-btn" onclick="scrollToContact('Sponsorship'); return false;">Sponsor Us</button>
                </div>
                <div class="footer-socials about-socials" id="about-socials" style="margin-top: 16px;">
                    <!-- Dynamic social links will be loaded here -->
                </div>
            </div>
            
            <div class="solar-system">
                <div class="sun"></div>
                
                <!-- Mercury -->
                <div class="orbit orbit-1">
                    <div class="planet planet-1"></div>
                </div>
                
                <!-- Venus -->
                <div class="orbit orbit-2">
                    <div class="planet planet-2"></div>
                </div>
                
                <!-- Earth -->
                <div class="orbit orbit-3">
                    <div class="planet planet-3"></div>
                </div>
                
                <!-- Mars -->
                <div class="orbit orbit-4">
                    <div class="planet planet-4"></div>
                </div>
                
                <!-- Jupiter -->
                <div class="orbit orbit-5">
                    <div class="planet planet-5"></div>
                </div>
                
                <!-- Saturn -->
                <div class="orbit orbit-6">
                    <div class="planet planet-6">
                        <div class="saturn-ring"></div>
                    </div>
                </div>
                
                <!-- Uranus -->
                <div class="orbit orbit-7">
                    <div class="planet planet-7">
                        <div class="uranus-ring"></div>
                    </div>
                </div>
                
                <!-- Neptune -->
                <div class="orbit orbit-8">
                    <div class="planet planet-8"></div>
                </div>
            </div>
        </section>

        <!-- Mission Blocks -->
        <div class="missions-container" id="missions">
            <div class="mission-block" onclick="openMission(1)">
                <div class="mission-background"></div>
                <div class="mission-overlay">
                    <div>
                        <h2 class="mission-title" id="mission1-title">Loading...</h2>
                        <p class="mission-subtitle" id="mission1-subtitle">Loading...</p>
                    </div>
                </div>
                <div class="mission-cta" id="mission-cta">CLICK TO READ MORE</div>
                <div class="mission-mobile-title">
                    <h2 id="mission1-mobile-title">Loading...</h2>
                    <p id="mission1-mobile-subtitle">Loading...</p>
                    <div class="mobile-cta" id="mission-mobile-cta">Click to learn more</div>
                </div>
            </div>
            <div class="mission-block" onclick="openMission(2)">
                <div class="mission-background"></div>
                <div class="mission-overlay">
                    <div>
                        <h2 class="mission-title" id="mission2-title">Loading...</h2>
                        <p class="mission-subtitle" id="mission2-subtitle">Loading...</p>
                    </div>
                </div>
                <div class="mission-cta">CLICK TO READ MORE</div>
                <div class="mission-mobile-title">
                    <h2 id="mission2-mobile-title">Loading...</h2>
                    <p id="mission2-mobile-subtitle">Loading...</p>
                    <div class="mobile-cta">Click to learn more</div>
                </div>
            </div>
            <div class="mission-block" onclick="openMission(3)">
                <div class="mission-background"></div>
                <div class="mission-overlay">
                    <div>
                        <h2 class="mission-title" id="mission3-title">Loading...</h2>
                        <p class="mission-subtitle" id="mission3-subtitle">Loading...</p>
                    </div>
                </div>
                <div class="mission-cta">CLICK TO READ MORE</div>
                <div class="mission-mobile-title">
                    <h2 id="mission3-mobile-title">Loading...</h2>
                    <p id="mission3-mobile-subtitle">Loading...</p>
                    <div class="mobile-cta">Click to learn more</div>
                </div>
            </div>
        </div>

        <!-- Sponsors Marquee Section -->
        <section class="sponsor-section">
            <div class="sponsor-inner">
                <div class="sponsor-title" id="sponsors-title">OUR MISSIONS ARE POSSIBLE THANKS TO OUR SPONSORS:</div>
                <div class="sponsor-marquee">
                    <div class="sponsor-track" id="sponsor-track">
                        <!-- Dynamic sponsor content will be loaded here -->
                    </div>
                </div>
                <div class="sponsor-actions">
                    <button class="sponsor-support-btn" onclick="scrollToContact('Sponsorship'); return false;">Support Our Missions</button>
                </div>
            </div>
        </section>

        <!-- Calendar Section -->
        <section class="calendar-section" id="calendar">
            <div class="calendar-inner">
                <div class="calendar-header">
                    <h2 class="calendar-title" id="calendar-title">Upcoming Events</h2>
                    <p class="calendar-subtitle" id="calendar-subtitle">Stay updated with our latest activities and milestones</p>
                </div>
                
                <!-- Interactive Calendar Widget -->
                <div class="calendar-widget" id="calendar-widget">
                    <div class="calendar-navigation">
                        <button class="calendar-nav-btn" id="prev-month" onclick="changeMonth(-1)">‹</button>
                        <div class="calendar-month-year" id="calendar-month-year">January 2025</div>
                        <button class="calendar-nav-btn" id="next-month" onclick="changeMonth(1)">›</button>
                    </div>
                    
                    <div class="calendar-grid">
                        <div class="calendar-weekdays">
                            <div class="calendar-weekday">Sun</div>
                            <div class="calendar-weekday">Mon</div>
                            <div class="calendar-weekday">Tue</div>
                            <div class="calendar-weekday">Wed</div>
                            <div class="calendar-weekday">Thu</div>
                            <div class="calendar-weekday">Fri</div>
                            <div class="calendar-weekday">Sat</div>
                        </div>
                        <div class="calendar-days" id="calendar-days">
                            <!-- Calendar days will be generated here -->
                        </div>
                    </div>
                </div>
                
                <!-- Events List (fallback) -->
                <div class="calendar-events" id="calendar-events" style="display: none;">
                    <!-- Dynamic calendar events will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section class="contact-section" id="contact">
            <div class="contact-inner">
                <div class="contact-title" id="contact-title">Contact Us</div>
                <div class="contact-subtext" id="contact-subtitle">Reach out and we'll get back to you as soon as possible.</div>
                <form class="contact-form" onsubmit="handleContactSubmit(event)">
                    <div class="form-grid">
                        <div class="form-row">
                            <label for="contact-name" id="form-name-label">Name</label>
                            <input id="contact-name" name="name" type="text" placeholder="Your full name" required>
                        </div>
                        <div class="form-row">
                            <label for="contact-email" id="form-email-label">Email</label>
                            <input id="contact-email" name="email" type="email" placeholder="you@example.com" required>
                        </div>
                        <div class="form-row">
                            <label for="contact-phone" id="form-phone-label">Phone Number</label>
                            <input id="contact-phone" name="phone" type="tel" placeholder="(555) 867-5309" required>
                        </div>
                        <div class="form-row">
                            <label for="contact-company" id="form-company-label">Company/Organization</label>
                            <input id="contact-company" name="company" type="text" placeholder="Your company or organization">
                        </div>
                        <div class="form-row">
                            <label for="contact-reason" id="form-reason-label">Reason for Contact</label>
                            <select id="contact-reason" name="reason" required>
                                <option value="" disabled selected>Select a reason</option>
                                <option>General Inquiry</option>
                                <option>Sponsorship</option>
                                <option>Partnership</option>
                                <option>Join the Team</option>
                                <option>Media</option>
                            </select>
                        </div>
                        <div class="form-row" style="grid-column: 1 / -1;">
                            <label for="contact-message" id="form-message-label">Message</label>
                            <textarea id="contact-message" name="message" placeholder="Type your message..." required></textarea>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary" id="form-submit">Send</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <div class="footer-content">
                <div class="footer-section">
                    <h3 id="footer-contact-title">Contact Us</h3>
                    <p>Email: <a href="mailto:axa.fau@outlook.com" id="footer-email">axa.fau@outlook.com</a></p>
                    <p>Phone: <a href="tel:18001234567" id="footer-phone">1800 123 4567</a></p>
                </div>
                <div class="footer-section">
                    <h3 id="footer-address-title">Address</h3>
                    <p id="footer-address">1966-1988 Dade Ave<br>Boca Raton, FL 33431</p>
                </div>
                <div class="footer-section">
                    <h3 id="footer-socials-title">Socials</h3>
                    <div class="footer-socials" id="footer-socials">
                        <!-- Dynamic social links will be loaded here -->
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p id="footer-copyright">&copy; 2025 AXA. All rights reserved.</p>
                <p id="footer-designed">Designed by <a href="https://charlierusso.dev/" target="_blank" rel="noopener noreferrer" id="footer-designer-link">Charles Russo</a></p>
            </div>
        </footer>
    </div>

    <!-- Mission Detail Page -->
    <div id="mission-detail-page">
        <div class="mission-content" id="mission-content"></div>
        
        <!-- Footer (duplicate for mission page) -->
        <footer>
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Contact Us</h3>
                    <p>Email: <a href="mailto:axa.fau@outlook.com">axa.fau@outlook.com</a></p>
                    <p>Phone: <a href="tel:18001234567">1800 123 4567</a></p>
                </div>
                <div class="footer-section">
                    <h3>Address</h3>
                    <p>1966-1988 Dade Ave<br>Boca Raton, FL 33431</p>
                </div>
                <div class="footer-section">
                    <h3>Socials</h3>
                    <div class="footer-socials" id="mission-footer-socials">
                        <!-- Dynamic social links will be loaded here -->
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p id="footer-copyright">&copy; 2025 AXA. All rights reserved.</p>
                <p id="footer-designed">Designed by <a href="https://charlierusso.dev/" target="_blank" rel="noopener noreferrer" id="footer-designer-link">Charles Russo</a></p>
            </div>
        </footer>
    </div>

    <!-- Lightbox -->
    <div id="lightbox" class="lightbox" onclick="closeLightbox()">
        <span class="lightbox-close">&times;</span>
        <img id="lightbox-img" src="" alt="Expanded view">
    </div>

    <!-- QR Code Button and Popup -->
    <button id="qr-button" class="qr-button" onclick="toggleQRPopup()">
        <div class="grid-pattern">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </button>

    <div id="qr-popup" class="qr-popup">
        <div class="qr-popup-content">
            <span class="qr-close" onclick="toggleQRPopup()">&times;</span>
            <div id="qr-code"></div>
            <p>Scan to visit our website</p>
        </div>
    </div>

    <!-- Confetti Success Popup -->
    <div id="confetti-popup" class="confetti-popup">
        <div class="confetti-content">
            <div class="confetti-icon">🚀</div>
            <h2 class="confetti-title">Message Sent Successfully!</h2>
            <p class="confetti-message" id="confetti-message">
                Thank you for reaching out! We've sent a confirmation email and will get back to you soon.
            </p>
            <button class="confetti-close" onclick="closeConfettiPopup()">Awesome!</button>
        </div>
    </div>

    <!-- Event Detail Popup -->
    <div id="event-popup" class="event-popup">
        <div class="event-popup-content">
            <span class="event-popup-close" onclick="closeEventPopup()">&times;</span>
            <div class="event-popup-header">
                <h3 class="event-popup-title" id="event-popup-title">Event Title</h3>
                <span class="event-popup-type" id="event-popup-type">mission</span>
            </div>
            <div class="event-popup-details">
                <div class="event-popup-date" id="event-popup-date">📅 Date</div>
                <div class="event-popup-time" id="event-popup-time">🕐 Time</div>
                <div class="event-popup-location" id="event-popup-location">📍 Location</div>
            </div>
            <div class="event-popup-description" id="event-popup-description">
                Event description will appear here.
            </div>
        </div>
    </div>

    <script>
        // Skip boot animation only when navigating internally
        function checkSkipBoot() {
            const skipBoot = sessionStorage.getItem('skipBoot');
            const hasInternalNavigation = window.location.hash.includes('mission');
            
            if (skipBoot === 'true' && hasInternalNavigation) {
                // Skip animation only when navigating between pages
                const bootContainer = document.getElementById('boot-container');
                const whiteBox = document.getElementById('white-box');
                const logoCentered = document.getElementById('logo-center');
                const mainWebsite = document.getElementById('main-website');
                
                bootContainer.style.display = 'none';
                whiteBox.style.display = 'none';
                logoCentered.classList.add('move-to-navbar');
                mainWebsite.classList.add('visible');
                document.body.style.overflow = 'auto';
            } else {
                // Set flag for internal navigation
                sessionStorage.setItem('skipBoot', 'true');
            }
        }

        // Run on page load
        window.addEventListener('load', () => {
            checkSkipBoot();
            updateBackButton();
        });

        // Handle back button visibility
        function updateBackButton() {
            const backBtn = document.querySelector('.global-back-btn');
            const missionPage = document.getElementById('mission-detail-page');
            
            if (missionPage.classList.contains('active')) {
                backBtn.style.display = 'flex';
            } else {
                backBtn.style.display = 'none';
            }
        }

        // Global back function
        function goBack() {
            const missionPage = document.getElementById('mission-detail-page');
            if (missionPage.classList.contains('active')) {
                goBackToMain();
            } else {
                window.history.back();
            }
        }

        // Home navigation
        function goToHome() {
            const mainWebsite = document.getElementById('main-website');
            const missionDetailPage = document.getElementById('mission-detail-page');
            const backBtn = document.querySelector('.global-back-btn');
            
            // Update URL and history
            window.history.pushState(null, '', window.location.pathname);
            
            // Switch views if needed
            missionDetailPage.classList.remove('active');
            mainWebsite.style.display = 'block';
            
            // Hide back button immediately
            backBtn.style.display = 'none';
            
            // Scroll to top smoothly
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Smooth scroll helpers for navbar
        function scrollToTop() {
            window.scrollTo({ top: 0, left: 0, behavior: 'smooth' });
        }

        function scrollToSection(sectionId, presetReason = null) {
            const missionPage = document.getElementById('mission-detail-page');
            const mainWebsite = document.getElementById('main-website');
            
            // If on mission page, return to main page first
            if (missionPage.classList.contains('active')) {
                missionPage.classList.remove('active');
                mainWebsite.style.display = 'block';
                updateBackButton();
                // Update URL and history
                window.history.pushState(null, '', window.location.pathname);
            }

            // Small delay to ensure smooth transition when coming from mission page
            setTimeout(() => {
                const el = document.getElementById(sectionId);
                if (!el) return;
                const y = el.getBoundingClientRect().top + window.pageYOffset - 90;
                window.scrollTo({ top: y, behavior: 'smooth' });

                // Handle contact form reason if provided
                if (sectionId === 'contact' && presetReason) {
                    setTimeout(() => {
                        const select = document.getElementById('contact-reason');
                        if (select) {
                            for (const option of select.options) {
                                if (option.text === presetReason) {
                                    select.value = option.value || option.text;
                                    break;
                                }
                            }
                        }
                    }, 250);
                }
            }, missionPage.classList.contains('active') ? 100 : 0);
        }

        function scrollToAbout() {
            scrollToSection('about');
        }

        function scrollToMissions() {
            scrollToSection('missions');
        }

        function scrollToContact(presetReason) {
            scrollToSection('contact', presetReason);
        }
        // Animation sequence controller
        const bootVideo = document.getElementById('boot-video');
        const bootContainer = document.getElementById('boot-container');
        const whiteBox = document.getElementById('white-box');
        const logoCentered = document.getElementById('logo-center');
        const mainWebsite = document.getElementById('main-website');

        // Smooth animation utility function
        function smoothAnimate(element, properties, duration, easing = 'ease-out') {
            return new Promise((resolve) => {
                const startTime = performance.now();
                const startValues = {};
                const endValues = {};
                
                // Get initial values
                Object.keys(properties).forEach(prop => {
                    if (prop === 'opacity') {
                        startValues[prop] = parseFloat(getComputedStyle(element)[prop]) || 0;
                    } else if (prop === 'transform') {
                        startValues[prop] = getComputedStyle(element)[prop];
                    } else {
                        startValues[prop] = parseFloat(getComputedStyle(element)[prop]) || 0;
                    }
                    endValues[prop] = properties[prop];
                });
                
                function animate(currentTime) {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    // Apply easing
                    let easedProgress = progress;
                    if (easing === 'ease-out') {
                        easedProgress = 1 - Math.pow(1 - progress, 3);
                    } else if (easing === 'ease-in-out') {
                        easedProgress = progress < 0.5 
                            ? 2 * progress * progress 
                            : 1 - Math.pow(-2 * progress + 2, 3) / 2;
                    }
                    
                    // Apply animated values
                    Object.keys(properties).forEach(prop => {
                        if (prop === 'opacity') {
                            element.style[prop] = startValues[prop] + (endValues[prop] - startValues[prop]) * easedProgress;
                        } else if (prop === 'transform') {
                            element.style[prop] = endValues[prop];
                        } else {
                            element.style[prop] = (startValues[prop] + (endValues[prop] - startValues[prop]) * easedProgress) + 'px';
                        }
                    });
                    
                    if (progress < 1) {
                        requestAnimationFrame(animate);
                    } else {
                        resolve();
                    }
                }
                
                requestAnimationFrame(animate);
            });
        }

        // Prevent body scrolling initially
        document.body.style.overflow = 'hidden';

        // Step 1: Wait for boot video to end
        bootVideo.addEventListener('ended', async () => {
            // Show black box immediately (before hiding boot video)
            whiteBox.classList.add('visible');
            
            // Hide boot video
            bootContainer.classList.add('hidden');
            
            setTimeout(async () => {
                bootContainer.style.display = 'none';
                
                // Show main website
                mainWebsite.classList.add('visible');
                
                // Step 2: Fade in logo at center with smooth animation
                await new Promise(resolve => setTimeout(resolve, 200));
                    logoCentered.classList.add('fade-in');
                    
                    // Step 3: After logo fades in, move it to navbar and slide black box up
                await new Promise(resolve => setTimeout(resolve, 500)); // Reduced from 600ms
                
                // Start both animations simultaneously for smoother effect
                        logoCentered.classList.add('move-to-navbar');
                        whiteBox.classList.add('slide-up');
                        
                        // Ensure scroll position is at top
                        window.scrollTo(0, 0);
                        
                        // Step 4: After animation completes, enable scrolling and cleanup
                        setTimeout(() => {
                            document.body.style.overflow = 'auto';
                            whiteBox.style.display = 'none';
                            // Allow free scrolling after boot animation - no forced scroll to top
                            
                            // Show QR button after boot sequence
                            setTimeout(() => {
                                const qrButton = document.getElementById('qr-button');
                                qrButton.classList.add('visible');
                }, 200);
                }, 2800); // Increased to match the slower logo animation duration
            }, 300); // Reduced from 500ms
        });

        // Optional: Skip to main site on click (for testing or user preference)
        bootVideo.addEventListener('click', () => {
            bootVideo.currentTime = bootVideo.duration;
        });

        // Fallback: If video doesn't autoplay, start sequence after short delay
        setTimeout(() => {
            if (bootVideo.paused) {
                bootVideo.play().catch(() => {
                    // If autoplay is blocked, skip directly to main site
                    whiteBox.classList.add('visible');
                    bootContainer.classList.add('hidden');
                    setTimeout(() => {
                        bootContainer.style.display = 'none';
                        mainWebsite.classList.add('visible');
                        setTimeout(() => logoCentered.classList.add('fade-in'), 200);
                    }, 500);
                });
            }
        }, 100);

        // Slideshow functionality
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        function showNextSlide() {
            slides[currentSlide].classList.remove('active');
            currentSlide = (currentSlide + 1) % totalSlides;
            slides[currentSlide].classList.add('active');
        }

        // Change slide every 5 seconds
        setInterval(showNextSlide, 5000);

        // JSON-based sponsor loading and marquee animation
        async function loadSponsors() {
            const track = document.getElementById('sponsor-track');
            if (!track) return;

            try {
                // ========================================
                // JSON CONFIG-BASED SPONSOR SYSTEM
                // ========================================
                // This system loads sponsors from sponsors.json config file
                // To add/remove sponsors: edit sponsors.json and refresh the page
                // ========================================
                
                console.log('Loading sponsors from sponsors.json...');
                
                // Fetch the sponsors configuration
                const response = await fetch('sponsors.json');
                if (!response.ok) {
                    throw new Error(`Failed to load sponsors.json: ${response.status}`);
                }
                
                const config = await response.json();
                const sponsors = config.sponsors || [];
                const settings = config.settings || {};
                
                // Store scroll speed globally for animation function
                window.sponsorScrollSpeed = settings.scrollSpeed || 0.5;
                
                if (settings.showConsoleLogs) {
                    console.log('Sponsors config loaded:', config);
                    console.log('Scroll speed set to:', window.sponsorScrollSpeed);
                }

                // Filter enabled sponsors and validate images
                const validSponsors = [];
                
                for (const sponsor of sponsors) {
                    // Skip disabled sponsors
                    if (sponsor.enabled === false) {
                        if (settings.showConsoleLogs) {
                            console.log(`⏭️ Skipping disabled sponsor: ${sponsor.filename}`);
                        }
                        continue;
                    }
                    
                    // Test if the image exists
                    try {
                        await new Promise((resolve, reject) => {
                            const img = new Image();
                            img.onload = () => resolve(sponsor);
                            img.onerror = () => reject(sponsor);
                            img.src = `media/sponsors/${sponsor.filename}`;
                        });
                        
                        validSponsors.push({
                            src: `media/sponsors/${sponsor.filename}`,
                            alt: sponsor.alt || sponsor.filename.replace(/\.[^/.]+$/, "").replace(/[-_]/g, ' ').replace(/\b\w/g, l => l.toUpperCase())
                        });
                        
                        if (settings.showConsoleLogs) {
                            console.log(`✓ Loaded sponsor: ${sponsor.filename}`);
                        }
                    } catch (error) {
                        if (settings.showConsoleLogs) {
                            console.warn(`⚠️ Sponsor image not found: ${sponsor.filename}`);
                        }
                    }
                }

                if (settings.showConsoleLogs) {
                    console.log(`Successfully loaded ${validSponsors.length} sponsor images`);
                }

                // If no valid sponsors found, show fallback message
                if (validSponsors.length === 0) {
                    const fallbackMessage = settings.fallbackMessage || config.sponsors?.fallbackMessage || 'No sponsor images found';
                    track.innerHTML = `<div class="sponsor-strip"><div class="sponsor-item" style="text-align: center; color: #666; font-style: italic;">${fallbackMessage}</div></div>`;
                    return;
                }

                // Create sponsor strips HTML
                let sponsorHTML = '';
                
                // Create two identical strips for seamless looping
                for (let stripIndex = 0; stripIndex < 2; stripIndex++) {
                    sponsorHTML += '<div class="sponsor-strip">';
                    
                    validSponsors.forEach(sponsor => {
                        sponsorHTML += `
                            <div class="sponsor-item">
                                <img src="${sponsor.src}" alt="${sponsor.alt}">
                            </div>
                        `;
                    });
                    
                    sponsorHTML += '</div>';
                }

                // Insert the HTML
                track.innerHTML = sponsorHTML;

                // Start the marquee animation after a short delay to ensure DOM is ready
                setTimeout(() => {
                    startMarqueeAnimation();
                }, 100);

            } catch (error) {
                console.error('Error loading sponsors:', error);
                track.innerHTML = '<div class="sponsor-strip"><div class="sponsor-item" style="text-align: center; color: #666; font-style: italic;">Error loading sponsors</div></div>';
            }
        }

        function startMarqueeAnimation() {
            const track = document.querySelector('.sponsor-track');
            if (!track) return;

            // Get the width of a single strip
            const firstStrip = track.querySelector('.sponsor-strip');
            if (!firstStrip) return;

            const stripWidth = firstStrip.offsetWidth;
            let scrollPosition = 0;

            function animate() {
                // Get scroll speed from global config (set during loadSponsors)
                const scrollSpeed = window.sponsorScrollSpeed || 0.5;
                scrollPosition -= scrollSpeed;
                
                // Use modulo to create seamless loop without visible jump
                // This ensures the animation continues smoothly
                if (scrollPosition <= -stripWidth) {
                    scrollPosition = 0;
                }

                // Apply the transform with smooth transition
                track.style.transform = `translateX(${scrollPosition}px)`;
                requestAnimationFrame(animate);
            }

            // Start the animation
            animate();
        }

        // Utility function to refresh sponsors (can be called manually if needed)
        function refreshSponsors() {
            console.log('Refreshing sponsor carousel from sponsors.json...');
            loadSponsors();
        }

        // Function to get current sponsors config (for debugging)
        async function getSponsorsConfig() {
            try {
                const response = await fetch('sponsors.json');
                const config = await response.json();
                console.log('Current sponsors config:', config);
                return config;
            } catch (error) {
                console.error('Error loading sponsors config:', error);
                return null;
            }
        }

        // Function to validate a sponsor image exists
        async function validateSponsorImage(filename) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve(true);
                img.onerror = () => resolve(false);
                img.src = `media/sponsors/${filename}`;
            });
        }

        // Social Media Configuration System
        let socialConfig = null;

        // Load social media configuration
        async function loadSocialConfig() {
            try {
                console.log('Loading social media configuration from social-config.json...');
                
                // Add cache-busting parameter to prevent caching
                const timestamp = new Date().getTime();
                const cacheBuster = `?v=${timestamp}&cb=${Math.random()}`;
                
                const response = await fetch(`social-config.json${cacheBuster}`, {
                    cache: 'no-cache',
                    headers: {
                        'Cache-Control': 'no-cache, no-store, must-revalidate',
                        'Pragma': 'no-cache',
                        'Expires': '0'
                    }
                });
                if (!response.ok) {
                    throw new Error(`Failed to load social-config.json: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Validate the data structure
                if (!data || !data.socialMedia) {
                    throw new Error('Invalid social-config.json structure: missing socialMedia object');
                }
                
                socialConfig = data;
                
                if (socialConfig.settings && socialConfig.settings.showConsoleLogs) {
                    console.log('Social config loaded successfully:', socialConfig);
                }

                // Apply social links to all sections
                applySocialLinks();
                
            } catch (error) {
                console.error('Error loading social configuration:', error);
                console.error('Using fallback social links instead.');
                // Use fallback social links
                applyFallbackSocialLinks();
            }
        }

        // Apply social links to all sections
        function applySocialLinks() {
            if (!socialConfig || !socialConfig.socialMedia) {
                console.warn('Social config not loaded, using fallback');
                applyFallbackSocialLinks();
                return;
            }

            const socialMedia = socialConfig.socialMedia;
            const settings = socialConfig.settings || {};
            const openInNewTab = settings.openInNewTab !== false; // Default to true

            if (settings.showConsoleLogs) {
                console.log('Applying social links from configuration...');
            }

            // Get all social link containers
            const containers = [
                'nav-socials',
                'mobile-socials', 
                'about-socials',
                'footer-socials',
                'mission-footer-socials'
            ];

            let appliedCount = 0;
            containers.forEach(containerId => {
                const container = document.getElementById(containerId);
                if (container) {
                    container.innerHTML = generateSocialLinksHTML(socialMedia, openInNewTab);
                    appliedCount++;
                    if (settings.showConsoleLogs) {
                        console.log(`Applied social links to container: ${containerId}`);
                    }
                } else if (settings.showConsoleLogs) {
                    console.warn(`Container not found: ${containerId}`);
                }
            });

            if (settings.showConsoleLogs) {
                console.log(`Successfully applied social links to ${appliedCount} containers`);
            }

            // Update WhatsApp join button
            updateWhatsAppButton();
        }

        // Generate HTML for social links
        function generateSocialLinksHTML(socialMedia, openInNewTab) {
            let html = '';
            
            Object.entries(socialMedia).forEach(([platform, config]) => {
                if (config.enabled) {
                    const target = openInNewTab && platform !== 'email' ? ' target="_blank" rel="noopener noreferrer"' : '';
                    html += `
                        <a href="${config.url}"${target}>
                            <img src="${config.icon}" alt="${config.alt}">
                        </a>
                    `;
                }
            });
            
            return html;
        }

        // Update WhatsApp join buttons
        function updateWhatsAppButton() {
            if (socialConfig && socialConfig.socialMedia && socialConfig.socialMedia.whatsapp) {
                const whatsappUrl = socialConfig.socialMedia.whatsapp.url;
                
                // Update about section join button
                const aboutJoinButton = document.getElementById('about-join-btn');
                if (aboutJoinButton) {
                    aboutJoinButton.setAttribute('data-whatsapp-url', whatsappUrl);
                    if (socialConfig.settings && socialConfig.settings.showConsoleLogs) {
                        console.log('Updated about join button with URL:', whatsappUrl);
                    }
                } else if (socialConfig.settings && socialConfig.settings.showConsoleLogs) {
                    console.warn('About join button not found (about-join-btn)');
                }
                
                // Update navbar join button
                const navJoinButton = document.getElementById('nav-join');
                if (navJoinButton) {
                    navJoinButton.setAttribute('data-whatsapp-url', whatsappUrl);
                    if (socialConfig.settings && socialConfig.settings.showConsoleLogs) {
                        console.log('Updated navbar join button with URL:', whatsappUrl);
                    }
                } else if (socialConfig.settings && socialConfig.settings.showConsoleLogs) {
                    console.warn('Navbar join button not found (nav-join)');
                }
            }
        }

        // Open WhatsApp function
        function openWhatsApp() {
            console.log('Join button clicked, checking social config...');
            
            // First try to get URL from any button data attribute
            const aboutJoinButton = document.getElementById('about-join-btn');
            const navJoinButton = document.getElementById('nav-join');
            
            let whatsappUrl = null;
            
            if (aboutJoinButton && aboutJoinButton.getAttribute('data-whatsapp-url')) {
                whatsappUrl = aboutJoinButton.getAttribute('data-whatsapp-url');
                console.log('Using WhatsApp URL from about button data:', whatsappUrl);
            } else if (navJoinButton && navJoinButton.getAttribute('data-whatsapp-url')) {
                whatsappUrl = navJoinButton.getAttribute('data-whatsapp-url');
                console.log('Using WhatsApp URL from navbar button data:', whatsappUrl);
            }
            
            if (whatsappUrl) {
                window.open(whatsappUrl, '_blank', 'noopener,noreferrer');
                return;
            }
            
            // Fallback to social config
            if (socialConfig && socialConfig.socialMedia && socialConfig.socialMedia.whatsapp) {
                const whatsappUrl = socialConfig.socialMedia.whatsapp.url;
                console.log('Using WhatsApp URL from social config:', whatsappUrl);
                window.open(whatsappUrl, '_blank', 'noopener,noreferrer');
            } else {
                console.warn('Social config not loaded or WhatsApp URL not found, using fallback');
                // Fallback
                window.open('https://www.whatsapp.com/', '_blank', 'noopener,noreferrer');
            }
        }

        // Force refresh social config (useful for testing)
        async function refreshSocialConfig() {
            console.log('Force refreshing social configuration...');
            await loadSocialConfig();
        }

        // Force update join buttons with current social config
        function forceUpdateJoinButton() {
            console.log('Force updating join buttons...');
            if (socialConfig && socialConfig.socialMedia && socialConfig.socialMedia.whatsapp) {
                const whatsappUrl = socialConfig.socialMedia.whatsapp.url;
                
                // Update about section join button
                const aboutJoinButton = document.getElementById('about-join-btn');
                if (aboutJoinButton) {
                    aboutJoinButton.setAttribute('data-whatsapp-url', whatsappUrl);
                    console.log('About join button updated with URL:', whatsappUrl);
                } else {
                    console.warn('About join button not found');
                }
                
                // Update navbar join button
                const navJoinButton = document.getElementById('nav-join');
                if (navJoinButton) {
                    navJoinButton.setAttribute('data-whatsapp-url', whatsappUrl);
                    console.log('Navbar join button updated with URL:', whatsappUrl);
                } else {
                    console.warn('Navbar join button not found');
                }
            } else {
                console.warn('Social config not loaded or WhatsApp URL not found');
            }
        }

        // Mission Configuration Functions
        let generalConfig = null; // Cache for general config

        // Load mission card data from general.json
        async function loadMissionCards() {
            try {
                console.log('Loading mission cards from general.json...');
                
                const response = await fetch('general.json?v=' + Date.now());
                if (!response.ok) {
                    throw new Error(`Failed to load general.json: ${response.status}`);
                }
                
                generalConfig = await response.json();
                const missions = generalConfig.missions || {};
                
                // Update Mission 1
                if (missions.mission1) {
                    updateMissionCard(1, missions.mission1.title, missions.mission1.subtitle, missions.mission1.backgroundImage);
                }
                
                // Update Mission 2
                if (missions.mission2) {
                    updateMissionCard(2, missions.mission2.title, missions.mission2.subtitle, missions.mission2.backgroundImage);
                }
                
                // Update Mission 3
                if (missions.mission3) {
                    updateMissionCard(3, missions.mission3.title, missions.mission3.subtitle, missions.mission3.backgroundImage);
                }
                
                // Update CTA text if available
                if (missions.cta) {
                    const ctaElements = document.querySelectorAll('.mission-cta');
                    ctaElements.forEach(el => el.textContent = missions.cta);
                }
                
                if (missions.mobileCta) {
                    const mobileCtaElements = document.querySelectorAll('.mobile-cta');
                    mobileCtaElements.forEach(el => el.textContent = missions.mobileCta);
                }
                
                console.log('Mission cards loaded successfully');
                
            } catch (error) {
                console.error('Error loading mission cards:', error);
                // Fallback to default values
                updateMissionCard(1, 'MISSION 1', '2024 - Orbital Agriculture', 'media/placeholder.jpg');
                updateMissionCard(2, 'MISSION 2', '2024 - Cosmic Radiation Study', 'media/placeholder.jpg');
                updateMissionCard(3, 'MISSION 3', '2024 - Deep Space Communication', 'media/placeholder.jpg');
            }
        }

        // Update individual mission card
        function updateMissionCard(missionNumber, title, subtitle, backgroundImage) {
            // Update desktop version
            const titleElement = document.getElementById(`mission${missionNumber}-title`);
            const subtitleElement = document.getElementById(`mission${missionNumber}-subtitle`);
            
            if (titleElement) titleElement.textContent = title;
            if (subtitleElement) subtitleElement.textContent = subtitle;
            
            // Update mobile version
            const mobileTitleElement = document.getElementById(`mission${missionNumber}-mobile-title`);
            const mobileSubtitleElement = document.getElementById(`mission${missionNumber}-mobile-subtitle`);
            
            if (mobileTitleElement) mobileTitleElement.textContent = title;
            if (mobileSubtitleElement) mobileSubtitleElement.textContent = subtitle;
            
            // Update background image
            if (backgroundImage) {
                const missionBlock = document.querySelector(`.mission-block:nth-child(${missionNumber})`);
                if (missionBlock) {
                    const backgroundElement = missionBlock.querySelector('.mission-background');
                    if (backgroundElement) {
                        backgroundElement.style.backgroundImage = `url('${backgroundImage}')`;
                        console.log(`Updated mission ${missionNumber} background to: ${backgroundImage}`);
                    }
                }
            }
        }

        // Mission Image Gallery Functions
        let missionImageCache = {}; // Cache for mission images

        // Load images for a specific mission from config file
        async function loadMissionImages(missionNumber, forceRefresh = false) {
            try {
                console.log(`Loading images for mission ${missionNumber} from config...`);
                
                // Load mission config
                const configResponse = await fetch(`mission${missionNumber}-config.json?v=${Date.now()}`);
                if (!configResponse.ok) {
                    throw new Error(`Failed to load mission ${missionNumber} config`);
                }
                
                const config = await configResponse.json();
                const imageFiles = config.images || [];
                
                console.log(`Found ${imageFiles.length} images for mission ${missionNumber}:`, imageFiles);
                
                if (imageFiles.length > 0) {
                    displayMissionImages(missionNumber, imageFiles);
                } else {
                    console.log(`No images found in mission ${missionNumber} config, showing empty gallery`);
                    displayEmptyGallery(missionNumber);
                }
                
            } catch (error) {
                console.error(`Error loading images for mission ${missionNumber}:`, error);
                displayEmptyGallery(missionNumber);
            }
        }


        // Check if an image exists with cache busting (more efficient)
        async function imageExistsWithCacheBust(url) {
            try {
                const timestamp = new Date().getTime();
                const cacheBuster = `?v=${timestamp}&cb=${Math.random()}`;
                const response = await fetch(url + cacheBuster, { method: 'HEAD' });
                return response.ok;
            } catch (error) {
                return false;
            }
        }

        // Check if an image exists (legacy function)
        function imageExists(url) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve(true);
                img.onerror = () => resolve(false);
                img.src = url;
            });
        }

        // Display mission images in the gallery
        function displayMissionImages(missionNumber, imageFiles) {
            const gallery = document.getElementById(`mission-gallery-${missionNumber}`);
            const seeMoreBtn = document.getElementById(`see-more-btn-${missionNumber}`);
            
            if (!gallery) return;
            
            // Show first 8 images
            const initialImages = imageFiles.slice(0, 8);
            const remainingImages = imageFiles.slice(8);
            
            gallery.innerHTML = '';
            
            initialImages.forEach((imagePath, index) => {
                const img = document.createElement('img');
                // Add cache busting to the image source
                const timestamp = new Date().getTime();
                const cacheBuster = `?v=${timestamp}&cb=${Math.random()}`;
                img.src = imagePath + cacheBuster;
                img.className = 'gallery-image';
                img.alt = `Mission ${missionNumber} Image ${index + 1}`;
                img.onclick = () => openLightbox(imagePath);
                gallery.appendChild(img);
            });
            
            // Show "See More" button if there are more than 8 images
            if (remainingImages.length > 0) {
                seeMoreBtn.style.display = 'block';
                seeMoreBtn.setAttribute('data-remaining-images', JSON.stringify(remainingImages));
            }
        }

        // Show more images when "See More" is clicked
        function showMoreImages(missionNumber) {
            const gallery = document.getElementById(`mission-gallery-${missionNumber}`);
            const seeMoreBtn = document.getElementById(`see-more-btn-${missionNumber}`);
            
            if (!gallery || !seeMoreBtn) return;
            
            const remainingImages = JSON.parse(seeMoreBtn.getAttribute('data-remaining-images') || '[]');
            
            remainingImages.forEach((imagePath, index) => {
                const img = document.createElement('img');
                // Add cache busting to the image source
                const timestamp = new Date().getTime();
                const cacheBuster = `?v=${timestamp}&cb=${Math.random()}`;
                img.src = imagePath + cacheBuster;
                img.className = 'gallery-image';
                img.alt = `Mission ${missionNumber} Image ${gallery.children.length + index + 1}`;
                img.onclick = () => openLightbox(imagePath);
                gallery.appendChild(img);
            });
            
            // Hide the "See More" button
            seeMoreBtn.style.display = 'none';
        }

        // Display empty gallery when no images are found
        function displayEmptyGallery(missionNumber) {
            const gallery = document.getElementById(`mission-gallery-${missionNumber}`);
            const seeMoreBtn = document.getElementById(`see-more-btn-${missionNumber}`);
            
            if (!gallery) return;
            
            // Clear the gallery
            gallery.innerHTML = '';
            
            // Hide the "See More" button
            if (seeMoreBtn) {
                seeMoreBtn.style.display = 'none';
            }
            
            console.log(`Gallery for mission ${missionNumber} is now empty`);
        }

        // Clear mission image cache and force fresh reload
        function clearMissionCache(missionNumber = null) {
            if (missionNumber) {
                delete missionImageCache[missionNumber];
                console.log(`Cleared cache for mission ${missionNumber}`);
            } else {
                missionImageCache = {};
                console.log('Cleared all mission image cache');
            }
        }

        // Force refresh mission images (like sponsor carousel refresh)
        async function refreshMissionImages(missionNumber) {
            console.log(`Force refreshing images for mission ${missionNumber}...`);
            await loadMissionImages(missionNumber, true);
        }
        
        // Force refresh all mission images
        async function refreshAllMissionImages() {
            console.log('Force refreshing all mission images...');
            for (let i = 1; i <= 3; i++) {
                await loadMissionImages(i, true);
            }
        }

        // List all images in a mission config (for debugging)
        async function listMissionImages(missionNumber) {
            console.log(`Listing all images for mission ${missionNumber} from config...`);
            try {
                const configResponse = await fetch(`mission${missionNumber}-config.json?v=${Date.now()}`);
                if (!configResponse.ok) {
                    throw new Error(`Failed to load mission ${missionNumber} config`);
                }
                const config = await configResponse.json();
                const images = config.images || [];
                console.log(`Found ${images.length} images:`, images);
                return images;
            } catch (error) {
                console.error(`Error loading mission ${missionNumber} config:`, error);
                return [];
            }
        }

        // Force complete cache clear and reload
        function forceClearAllCache() {
            // Clear all mission cache
            missionImageCache = {};
            window.missionCustomPaths = {};
            
            // Clear any other caches
            if (window.socialConfig) {
                window.socialConfig = null;
            }
            
            console.log('All caches cleared. Please refresh the page.');
        }

        // Load sponsors for mission pages (exact copy of home page logic)
        async function loadMissionSponsors(missionNumber) {
            const track = document.getElementById(`mission-sponsor-track-${missionNumber}`);
            if (!track) return;

            try {
                console.log(`Loading sponsors for mission ${missionNumber}...`);
                
                // Fetch the sponsors configuration
                const response = await fetch('sponsors.json');
                if (!response.ok) {
                    throw new Error(`Failed to load sponsors.json: ${response.status}`);
                }
                
                const config = await response.json();
                const sponsors = config.sponsors || [];
                const settings = config.settings || {};
                
                // Store scroll speed globally for animation function
                window.sponsorScrollSpeed = settings.scrollSpeed || 0.5;
                
                if (settings.showConsoleLogs) {
                    console.log(`Sponsors config loaded for mission ${missionNumber}:`, config);
                    console.log('Scroll speed set to:', window.sponsorScrollSpeed);
                }

                // Filter enabled sponsors and validate images
                const validSponsors = [];
                
                for (const sponsor of sponsors) {
                    if (sponsor.enabled === false) {
                        if (settings.showConsoleLogs) {
                            console.log(`⏭️ Skipping disabled sponsor: ${sponsor.filename}`);
                        }
                        continue;
                    }
                    
                    // Test if the image exists
                    try {
                        await new Promise((resolve, reject) => {
                            const img = new Image();
                            img.onload = () => resolve(sponsor);
                            img.onerror = () => reject(sponsor);
                            img.src = `media/sponsors/${sponsor.filename}`;
                        });
                        
                        validSponsors.push({
                            src: `media/sponsors/${sponsor.filename}`,
                            alt: sponsor.alt || sponsor.filename.replace(/\.[^/.]+$/, "").replace(/[-_]/g, ' ').replace(/\b\w/g, l => l.toUpperCase())
                        });
                        
                        if (settings.showConsoleLogs) {
                            console.log(`✓ Loaded sponsor: ${sponsor.filename}`);
                        }
                    } catch (error) {
                        if (settings.showConsoleLogs) {
                            console.warn(`⚠️ Sponsor image not found: ${sponsor.filename}`);
                        }
                    }
                }

                if (settings.showConsoleLogs) {
                    console.log(`Successfully loaded ${validSponsors.length} sponsor images for mission ${missionNumber}`);
                }

                // If no valid sponsors found, show fallback message
                if (validSponsors.length === 0) {
                    track.innerHTML = '<div class="sponsor-strip"><div class="sponsor-item" style="text-align: center; color: #666; font-style: italic;">No sponsor images found</div></div>';
                    return;
                }

                // Create sponsor strips HTML (exact copy of home page)
                let sponsorHTML = '';
                
                // Create two identical strips for seamless looping
                for (let stripIndex = 0; stripIndex < 2; stripIndex++) {
                    sponsorHTML += '<div class="sponsor-strip">';
                    
                    validSponsors.forEach(sponsor => {
                        sponsorHTML += `
                            <div class="sponsor-item">
                                <img src="${sponsor.src}" alt="${sponsor.alt}">
                            </div>
                        `;
                    });
                    
                    sponsorHTML += '</div>';
                }

                // Insert the HTML
                track.innerHTML = sponsorHTML;

                // Start the marquee animation after a short delay to ensure DOM is ready
                setTimeout(() => {
                    startMissionMarqueeAnimation(missionNumber);
                }, 100);

            } catch (error) {
                console.error(`Error loading sponsors for mission ${missionNumber}:`, error);
                track.innerHTML = '<div class="sponsor-strip"><div class="sponsor-item" style="text-align: center; color: #666; font-style: italic;">Error loading sponsors</div></div>';
            }
        }

        // Start marquee animation for mission pages (exact copy of home page)
        function startMissionMarqueeAnimation(missionNumber) {
            const track = document.getElementById(`mission-sponsor-track-${missionNumber}`);
            if (!track) return;

            // Get the width of a single strip
            const firstStrip = track.querySelector('.sponsor-strip');
            if (!firstStrip) return;

            const stripWidth = firstStrip.offsetWidth;
            let scrollPosition = 0;

            function animate() {
                // Get scroll speed from global config (set during loadSponsors)
                const scrollSpeed = window.sponsorScrollSpeed || 0.5;
                scrollPosition -= scrollSpeed;
                
                // Use modulo to create seamless loop without visible jump
                // This ensures the animation continues smoothly
                if (scrollPosition <= -stripWidth) {
                    scrollPosition = 0;
                }

                // Apply the transform with smooth transition
                track.style.transform = `translateX(${scrollPosition}px)`;
                requestAnimationFrame(animate);
            }

            // Start the animation
            animate();
            
            console.log(`Started marquee animation for mission ${missionNumber} with speed: ${window.sponsorScrollSpeed || 0.5}`);
        }

        // Navigate to home page and scroll to contact form
        function goToHomeAndContact(reason = '') {
            // Close mission detail page
            const mainWebsite = document.getElementById('main-website');
            const missionDetailPage = document.getElementById('mission-detail-page');
            
            if (missionDetailPage && missionDetailPage.classList.contains('active')) {
                missionDetailPage.classList.remove('active');
                mainWebsite.style.display = 'block';
                
                // Update back button visibility
                updateBackButton();
                
                // Update URL
                window.history.pushState({}, '', window.location.pathname);
                
                // Scroll to contact section
                setTimeout(() => {
                    scrollToContact(reason);
                }, 100);
            } else {
                // If not on mission page, just scroll to contact
                scrollToContact(reason);
            }
        }

        // Fallback to load images from config (kept for potential future use)
        async function loadConfigImages(missionNumber) {
            try {
                const response = await fetch(`mission${missionNumber}-config.json`);
                const config = await response.json();
                
                const gallery = document.getElementById(`mission-gallery-${missionNumber}`);
                if (!gallery) return;
                
                gallery.innerHTML = '';
                
                config.images.forEach((imagePath, index) => {
                    const img = document.createElement('img');
                    img.src = imagePath;
                    img.className = 'gallery-image';
                    img.alt = `Mission ${missionNumber} Image ${index + 1}`;
                    img.onclick = () => openLightbox(imagePath);
                    gallery.appendChild(img);
                });
                
            } catch (error) {
                console.error(`Error loading config images for mission ${missionNumber}:`, error);
            }
        }

        // Fallback social links (current hardcoded links)
        function applyFallbackSocialLinks() {
            const fallbackHTML = `
                <a href="https://www.instagram.com/axa_fau/" target="_blank" rel="noopener noreferrer">
                    <img src="media/logos/instagram.webp" alt="Instagram">
                </a>
                <a href="https://www.facebook.com/fauaxa/" target="_blank" rel="noopener noreferrer">
                    <img src="media/logos/facebook.webp" alt="Facebook">
                </a>
                <a href="mailto:axa.fau@outlook.com">
                    <img src="media/logos/email.webp" alt="Email">
                </a>
                <a href="https://www.whatsapp.com/" target="_blank" rel="noopener noreferrer">
                    <img src="media/logos/whatsapp.png" alt="WhatsApp">
                </a>
            `;

            const containers = [
                'nav-socials',
                'mobile-socials', 
                'about-socials',
                'footer-socials',
                'mission-footer-socials'
            ];

            containers.forEach(containerId => {
                const container = document.getElementById(containerId);
                if (container) {
                    container.innerHTML = fallbackHTML;
                }
            });
        }

        // Interactive Calendar System
        let calendarConfig = null;
        let currentDate = new Date();
        let events = [];
        let recurringEvents = [];

        // Load calendar configuration
        async function loadCalendarConfig() {
            try {
                console.log('Loading calendar configuration from calendar.json...');
                
                const response = await fetch('calendar.json');
                if (!response.ok) {
                    throw new Error(`Failed to load calendar.json: ${response.status}`);
                }
                
                calendarConfig = await response.json();
                
                if (calendarConfig.settings && calendarConfig.settings.showConsoleLogs) {
                    console.log('Calendar config loaded:', calendarConfig);
                }

                // Apply calendar configuration
                applyCalendarConfig();
                
            } catch (error) {
                console.error('Error loading calendar configuration:', error);
                // Show fallback message
                showCalendarFallback();
            }
        }

        // Apply calendar configuration
        function applyCalendarConfig() {
            if (!calendarConfig || !calendarConfig.calendar) {
                console.warn('Calendar config not loaded, using fallback');
                showCalendarFallback();
                return;
            }

            const calendar = calendarConfig.calendar;
            events = calendarConfig.events || [];
            recurringEvents = calendarConfig.recurringEvents || [];

            // Update calendar header
            if (calendar.title) {
                const titleElement = document.getElementById('calendar-title');
                if (titleElement) titleElement.textContent = calendar.title;
            }
            
            if (calendar.subtitle) {
                const subtitleElement = document.getElementById('calendar-subtitle');
                if (subtitleElement) subtitleElement.textContent = calendar.subtitle;
            }

            // Show/hide calendar section
            const calendarSection = document.getElementById('calendar');
            if (calendarSection) {
                calendarSection.style.display = calendar.enabled ? 'block' : 'none';
            }

            // Initialize interactive calendar
            if (calendar.enabled) {
                initializeCalendar();
            } else {
                showCalendarEmpty();
            }
        }

        // Check if device is mobile
        function isMobile() {
            return window.innerWidth <= 768;
        }

        // Initialize the interactive calendar
        function initializeCalendar() {
            currentDate = new Date();
            
            if (isMobile()) {
                showMobileEventsList();
            } else {
                renderCalendar();
            }
            
            // Add resize listener to handle window size changes
            window.addEventListener('resize', () => {
                if (isMobile()) {
                    showMobileEventsList();
                } else {
                    const calendarWidget = document.getElementById('calendar-widget');
                    const eventsContainer = document.getElementById('calendar-events');
                    if (calendarWidget) calendarWidget.style.display = 'block';
                    if (eventsContainer) eventsContainer.style.display = 'none';
                    renderCalendar();
                }
            });
        }

        // Render the calendar for the current month
        function renderCalendar() {
            const monthYearElement = document.getElementById('calendar-month-year');
            const daysContainer = document.getElementById('calendar-days');
            
            if (!monthYearElement || !daysContainer) return;

            // Update month/year display
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                              'July', 'August', 'September', 'October', 'November', 'December'];
            monthYearElement.textContent = `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;

            // Get first day of month and number of days
            const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = firstDay.getDay();

            // Clear previous days
            daysContainer.innerHTML = '';

            // Add empty cells for days before the first day of the month
            for (let i = 0; i < startingDayOfWeek; i++) {
                const dayElement = createDayElement(0, true);
                daysContainer.appendChild(dayElement);
            }

            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = createDayElement(day, false);
                daysContainer.appendChild(dayElement);
            }

            // Add empty cells for days after the last day of the month
            const totalCells = startingDayOfWeek + daysInMonth;
            const remainingCells = 42 - totalCells; // 6 weeks * 7 days
            for (let i = 0; i < remainingCells; i++) {
                const dayElement = createDayElement(0, true);
                daysContainer.appendChild(dayElement);
            }
        }

        // Create a day element
        function createDayElement(day, isOtherMonth) {
            const dayElement = document.createElement('div');
            dayElement.className = 'calendar-day';
            
            if (isOtherMonth) {
                dayElement.classList.add('other-month');
            } else {
                dayElement.textContent = day;
                
                // Check if this is today
                const today = new Date();
                if (currentDate.getFullYear() === today.getFullYear() &&
                    currentDate.getMonth() === today.getMonth() &&
                    day === today.getDate()) {
                    dayElement.classList.add('today');
                }

                // Check if this day has events
                const dayEvents = getEventsForDay(day);
                if (dayEvents.length > 0) {
                    dayElement.classList.add('has-event');
                    
                    // Add event indicators for all events (stacked at bottom)
                    dayEvents.forEach((event, index) => {
                        const indicator = document.createElement('div');
                        indicator.className = `event-indicator ${event.type}`;
                        indicator.style.bottom = `${2 + (index * 3)}px`;
                        indicator.style.left = `${2 + (index * 3)}px`;
                        indicator.style.width = '6px';
                        indicator.style.height = '6px';
                        dayElement.appendChild(indicator);
                    });
                    
                    // Add event titles for all events (stacked vertically)
                    console.log(`Day ${day} has ${dayEvents.length} events:`, dayEvents.map(e => e.title));
                    dayEvents.forEach((event, index) => {
                        const eventTitle = document.createElement('div');
                        eventTitle.className = 'event-title';
                        eventTitle.textContent = event.title;
                        eventTitle.style.position = 'absolute';
                        const topPosition = 22 + (index * 30);
                        eventTitle.style.top = `${topPosition}px`;
                        eventTitle.style.left = '4px';
                        eventTitle.style.right = '4px';
                        eventTitle.style.zIndex = `${10 + index}`;
                        eventTitle.style.fontSize = '10px';
                        eventTitle.style.padding = '1px 2px';
                        eventTitle.style.minHeight = '16px';
                        eventTitle.style.maxHeight = '18px';
                        eventTitle.style.lineHeight = '0.8';
                        eventTitle.style.background = 'rgba(255, 255, 255, 0.95)';
                        eventTitle.style.borderRadius = '2px';
                        eventTitle.style.boxShadow = '0 1px 2px rgba(0, 0, 0, 0.1)';
                        eventTitle.style.border = '1px solid #ddd';
                        eventTitle.style.textAlign = 'center';
                        eventTitle.style.color = '#00008f';
                        eventTitle.style.fontWeight = '500';
                        eventTitle.style.whiteSpace = 'normal';
                        eventTitle.style.wordWrap = 'break-word';
                        eventTitle.style.overflow = 'hidden';
                        eventTitle.style.display = '-webkit-box';
                        eventTitle.style.webkitLineClamp = '2';
                        eventTitle.style.lineClamp = '2';
                        eventTitle.style.webkitBoxOrient = 'vertical';
                        console.log(`Event ${index + 1}: "${event.title}" at top: ${topPosition}px`);
                        dayElement.appendChild(eventTitle);
                    });
                    
                    // Add click handler for events
                    dayElement.addEventListener('click', () => showEventPopup(dayEvents, day));
                    dayElement.style.cursor = 'pointer';
                } else {
                    // Add click handler for days without events
                    dayElement.addEventListener('click', () => showEmptyDayPopup(day));
                }
            }

            return dayElement;
        }

        // Get events for a specific day
        function getEventsForDay(day) {
            const targetDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);
            const allEvents = [];
            
            // Get regular events
            const regularEvents = events.filter(event => {
                if (!event.enabled) return false;
                
                // Parse date string properly to avoid timezone issues
                const eventDateStr = event.date;
                const [year, month, day] = eventDateStr.split('-').map(Number);
                const eventDate = new Date(year, month - 1, day); // month is 0-indexed in Date constructor
                
                return eventDate.getFullYear() === targetDate.getFullYear() &&
                       eventDate.getMonth() === targetDate.getMonth() &&
                       eventDate.getDate() === targetDate.getDate();
            });
            
            // Get recurring events
            const recurringEventsForDay = getRecurringEventsForDay(targetDate);
            
            // Combine all events
            allEvents.push(...regularEvents);
            allEvents.push(...recurringEventsForDay);
            
            // Sort events chronologically by time
            allEvents.sort((a, b) => {
                const timeA = a.time || '00:00';
                const timeB = b.time || '00:00';
                return timeA.localeCompare(timeB);
            });
            
            return allEvents;
        }

        // Get recurring events for a specific day
        function getRecurringEventsForDay(targetDate) {
            const eventsForDay = [];
            
            recurringEvents.forEach(recurringEvent => {
                if (!recurringEvent.enabled || !recurringEvent.recurrence) return;
                
                const recurrence = recurringEvent.recurrence;
                
                // Check if target date is within the recurrence period
                const startDate = new Date(recurrence.startDate);
                const endDate = new Date(recurrence.endDate);
                
                if (targetDate < startDate || targetDate > endDate) return;
                
                // Check if this date is excluded
                const dateStr = `${targetDate.getFullYear()}-${String(targetDate.getMonth() + 1).padStart(2, '0')}-${String(targetDate.getDate()).padStart(2, '0')}`;
                if (recurrence.exclusions && recurrence.exclusions.includes(dateStr)) return;
                
                // Check if this day matches the recurrence pattern
                if (recurrence.type === 'weekly') {
                    if (targetDate.getDay() === recurrence.dayOfWeek) {
                        // Create a virtual event for this day
                        const virtualEvent = {
                            ...recurringEvent,
                            date: dateStr,
                            isRecurring: true,
                            originalId: recurringEvent.id
                        };
                        eventsForDay.push(virtualEvent);
                    }
                }
            });
            
            return eventsForDay;
        }

        // Change month (navigate calendar)
        function changeMonth(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            renderCalendar();
        }

        // Show empty calendar state
        function showCalendarEmpty() {
            const eventsContainer = document.getElementById('calendar-events');
            if (eventsContainer) {
                eventsContainer.innerHTML = `
                    <div class="calendar-empty">
                        <h3>No Upcoming Events</h3>
                        <p>Check back soon for updates on our upcoming activities and milestones.</p>
                    </div>
                `;
                eventsContainer.style.display = 'block';
            }
        }

        // Show fallback when config fails to load
        function showCalendarFallback() {
            const eventsContainer = document.getElementById('calendar-events');
            if (eventsContainer) {
                eventsContainer.innerHTML = `
                    <div class="calendar-empty">
                        <h3>Events Coming Soon</h3>
                        <p>We're working on updating our event calendar. Please check back later.</p>
                    </div>
                `;
                eventsContainer.style.display = 'block';
            }
        }

        // Show mobile events list (next 5 upcoming events)
        function showMobileEventsList() {
            const calendarWidget = document.getElementById('calendar-widget');
            const eventsContainer = document.getElementById('calendar-events');
            
            // Hide calendar widget on mobile
            if (calendarWidget) {
                calendarWidget.style.display = 'none';
            }
            
            // Get all upcoming events
            const allEvents = [...events, ...getAllRecurringEvents()];
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            // Filter and sort upcoming events
            const upcomingEvents = allEvents
                .filter(event => {
                    if (!event.enabled) return false;
                    const eventDate = new Date(event.date);
                    eventDate.setHours(0, 0, 0, 0);
                    return eventDate >= today;
                })
                .sort((a, b) => {
                    const dateA = new Date(a.date);
                    const dateB = new Date(b.date);
                    if (dateA.getTime() === dateB.getTime()) {
                        const timeA = a.time || '00:00';
                        const timeB = b.time || '00:00';
                        return timeA.localeCompare(timeB);
                    }
                    return dateA - dateB;
                })
                .slice(0, 5); // Get next 5 events
            
            if (eventsContainer) {
                if (upcomingEvents.length === 0) {
                    eventsContainer.innerHTML = `
                        <div class="calendar-empty">
                            <h3>No Upcoming Events</h3>
                            <p>Check back soon for updates on our upcoming activities and milestones.</p>
                        </div>
                    `;
                } else {
                    eventsContainer.innerHTML = upcomingEvents.map(event => {
                        // Parse date string properly to avoid timezone issues
                        const [year, month, day] = event.date.split('-').map(Number);
                        const eventDate = new Date(year, month - 1, day); // month is 0-indexed
                        
                        // Format date manually to avoid timezone conversion issues
                        const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                                          'July', 'August', 'September', 'October', 'November', 'December'];
                        const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
                        const formattedDate = `${dayNames[eventDate.getDay()]}, ${monthNames[eventDate.getMonth()]} ${eventDate.getDate()}, ${eventDate.getFullYear()}`;
                        const formattedTime = formatTime(event.time, '12h');
                        
                        return `
                            <div class="calendar-event">
                                <div class="event-header">
                                    <h3 class="event-title">${event.title}</h3>
                                    <span class="event-type ${event.type}">${event.type}</span>
                                </div>
                                <div class="event-details">
                                    <div class="event-date">📅 ${formattedDate}</div>
                                    <div class="event-time">🕐 ${formattedTime}</div>
                                    <div class="event-location">${event.location}</div>
                                    <div class="event-description">${event.description}</div>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
                eventsContainer.style.display = 'block';
            }
        }

        // Get all recurring events for the current period
        function getAllRecurringEvents() {
            const allRecurringEvents = [];
            const today = new Date();
            const endDate = new Date();
            endDate.setMonth(endDate.getMonth() + 3); // Look ahead 3 months
            
            recurringEvents.forEach(recurringEvent => {
                if (!recurringEvent.enabled || !recurringEvent.recurrence) return;
                
                const recurrence = recurringEvent.recurrence;
                const startDate = new Date(recurrence.startDate);
                const endRecurrenceDate = new Date(recurrence.endDate);
                
                let currentDate = new Date(Math.max(startDate, today));
                
                while (currentDate <= endRecurrenceDate && currentDate <= endDate) {
                    const currentDateStr = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}-${String(currentDate.getDate()).padStart(2, '0')}`;
                    if (recurrence.exclusions && recurrence.exclusions.includes(currentDateStr)) {
                        currentDate.setDate(currentDate.getDate() + 1);
                        continue;
                    }
                    
                    if (recurrence.type === 'weekly' && currentDate.getDay() === recurrence.dayOfWeek) {
                        allRecurringEvents.push({
                            ...recurringEvent,
                            date: currentDateStr
                        });
                    }
                    
                    currentDate.setDate(currentDate.getDate() + 1);
                }
            });
            
            return allRecurringEvents;
        }

        // Show event popup
        function showEventPopup(dayEvents, day) {
            const popup = document.getElementById('event-popup');
            if (!popup || dayEvents.length === 0) return;

            if (dayEvents.length === 1) {
                // Single event - show details
                const event = dayEvents[0];
                
                // Format date - parse date string properly to avoid timezone issues
                const [year, month, day] = event.date.split('-').map(Number);
                const eventDate = new Date(year, month - 1, day); // month is 0-indexed
                const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                                  'July', 'August', 'September', 'October', 'November', 'December'];
                const formattedDate = `${monthNames[eventDate.getMonth()]} ${eventDate.getDate()}, ${eventDate.getFullYear()}`;
                
                // Format time
                const formattedTime = formatTime(event.time, '12h');
                
                // Update popup content
                document.getElementById('event-popup-title').textContent = event.title;
                document.getElementById('event-popup-type').textContent = event.type;
                document.getElementById('event-popup-type').className = `event-popup-type ${event.type}`;
                document.getElementById('event-popup-date').textContent = `📅 ${formattedDate}`;
                document.getElementById('event-popup-time').textContent = `🕐 ${formattedTime}`;
                document.getElementById('event-popup-location').textContent = event.location;
                document.getElementById('event-popup-description').textContent = event.description;
            } else {
                // Multiple events - show list
                // Parse date string properly to avoid timezone issues
                const [year, month, day] = dayEvents[0].date.split('-').map(Number);
                const eventDate = new Date(year, month - 1, day); // month is 0-indexed
                const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                                  'July', 'August', 'September', 'October', 'November', 'December'];
                const formattedDate = `${monthNames[eventDate.getMonth()]} ${eventDate.getDate()}, ${eventDate.getFullYear()}`;
                
                // Create events list
                let eventsList = '';
                dayEvents.forEach((event, index) => {
                    const formattedTime = formatTime(event.time, '12h');
                    eventsList += `
                        <div style="margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 5px; border-left: 4px solid #00008f;">
                            <div style="font-weight: bold; color: #00008f; margin-bottom: 5px;">${event.title}</div>
                            <div style="font-size: 0.9rem; color: #666;">🕐 ${formattedTime} | 📍 ${event.location}</div>
                            <div style="font-size: 0.8rem; color: #888; margin-top: 3px;">${event.description}</div>
                        </div>
                    `;
                });
                
                // Update popup content
                document.getElementById('event-popup-title').textContent = `${dayEvents.length} Events on ${formattedDate}`;
                document.getElementById('event-popup-type').textContent = 'multiple';
                document.getElementById('event-popup-type').className = 'event-popup-type';
                document.getElementById('event-popup-date').textContent = `📅 ${formattedDate}`;
                document.getElementById('event-popup-time').textContent = '';
                document.getElementById('event-popup-location').textContent = '';
                document.getElementById('event-popup-description').innerHTML = eventsList;
            }
            
            // Show popup
            popup.classList.add('active');
        }

        // Show empty day popup
        function showEmptyDayPopup(day) {
            const popup = document.getElementById('event-popup');
            if (!popup) return;

            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                              'July', 'August', 'September', 'October', 'November', 'December'];
            const formattedDate = `${monthNames[currentDate.getMonth()]} ${day}, ${currentDate.getFullYear()}`;
            
            // Update popup content for empty day
            document.getElementById('event-popup-title').textContent = 'No Events Scheduled';
            document.getElementById('event-popup-type').textContent = 'free';
            document.getElementById('event-popup-type').className = 'event-popup-type';
            document.getElementById('event-popup-date').textContent = `📅 ${formattedDate}`;
            document.getElementById('event-popup-time').textContent = '';
            document.getElementById('event-popup-location').textContent = '';
            document.getElementById('event-popup-description').textContent = 'This day is currently free. Check back later for updates on our upcoming activities.';
            
            // Show popup
            popup.classList.add('active');
        }

        // Close event popup
        function closeEventPopup() {
            const popup = document.getElementById('event-popup');
            if (popup) {
                popup.classList.remove('active');
            }
        }

        // Format time helper
        function formatTime(time, format) {
            if (format === '24h') return time;
            
            // Convert to 12-hour format
            const [hours, minutes] = time.split(':');
            const hour = parseInt(hours);
            const ampm = hour >= 12 ? 'PM' : 'AM';
            const hour12 = hour % 12 || 12;
            
            return `${hour12}:${minutes} ${ampm}`;
        }

        // Load and apply general configuration
        async function loadGeneralConfig() {
            try {
                console.log('Loading general configuration from general.json...');
                
                const response = await fetch('general.json');
                if (!response.ok) {
                    throw new Error(`Failed to load general.json: ${response.status}`);
                }
                
                const config = await response.json();
                
                if (config.settings && config.settings.showConsoleLogs) {
                    console.log('General config loaded:', config);
                }

                // Apply site configuration
                if (config.site) {
                    if (config.site.title) {
                        document.getElementById('site-title').textContent = config.site.title;
                        document.title = config.site.title;
                    }
                    if (config.site.favicon) {
                        const favicon = document.getElementById('site-favicon');
                        if (favicon) {
                            favicon.href = config.site.favicon;
                        }
                    }
                }

                // Apply navigation text
                if (config.navigation) {
                    const navMap = {
                        'nav-home': config.navigation.home,
                        'nav-about': config.navigation.about,
                        'nav-missions': config.navigation.missions,
                        'nav-join': config.navigation.join,
                        'nav-support': config.navigation.support,
                        'nav-contact': config.navigation.contact
                    };
                    
                    Object.entries(navMap).forEach(([id, text]) => {
                        const element = document.getElementById(id);
                        if (element && text) {
                            element.textContent = text;
                        }
                    });
                }

                // Apply hero section text
                if (config.hero) {
                    if (config.hero.title) {
                        const element = document.getElementById('hero-title');
                        if (element) element.textContent = config.hero.title;
                    }
                    if (config.hero.description) {
                        const element = document.getElementById('hero-description');
                        if (element) element.textContent = config.hero.description;
                    }
                }

                // Apply about section text
                if (config.about) {
                    if (config.about.title) {
                        const element = document.getElementById('about-title');
                        if (element) element.textContent = config.about.title;
                    }
                    if (config.about.content) {
                        const element = document.getElementById('about-content');
                        if (element) element.textContent = config.about.content;
                    }
                }

                // Apply mission text
                if (config.missions) {
                    // Mission 1
                    if (config.missions.mission1) {
                        if (config.missions.mission1.title) {
                            const elements = ['mission1-title', 'mission1-mobile-title'];
                            elements.forEach(id => {
                                const element = document.getElementById(id);
                                if (element) element.textContent = config.missions.mission1.title;
                            });
                        }
                        if (config.missions.mission1.subtitle) {
                            const elements = ['mission1-subtitle', 'mission1-mobile-subtitle'];
                            elements.forEach(id => {
                                const element = document.getElementById(id);
                                if (element) element.textContent = config.missions.mission1.subtitle;
                            });
                        }
                    }
                    
                    // Mission 2
                    if (config.missions.mission2) {
                        if (config.missions.mission2.title) {
                            const elements = ['mission2-title', 'mission2-mobile-title'];
                            elements.forEach(id => {
                                const element = document.getElementById(id);
                                if (element) element.textContent = config.missions.mission2.title;
                            });
                        }
                        if (config.missions.mission2.subtitle) {
                            const elements = ['mission2-subtitle', 'mission2-mobile-subtitle'];
                            elements.forEach(id => {
                                const element = document.getElementById(id);
                                if (element) element.textContent = config.missions.mission2.subtitle;
                            });
                        }
                    }
                    
                    // Mission 3
                    if (config.missions.mission3) {
                        if (config.missions.mission3.title) {
                            const elements = ['mission3-title', 'mission3-mobile-title'];
                            elements.forEach(id => {
                                const element = document.getElementById(id);
                                if (element) element.textContent = config.missions.mission3.title;
                            });
                        }
                        if (config.missions.mission3.subtitle) {
                            const elements = ['mission3-subtitle', 'mission3-mobile-subtitle'];
                            elements.forEach(id => {
                                const element = document.getElementById(id);
                                if (element) element.textContent = config.missions.mission3.subtitle;
                            });
                        }
                    }
                    
                    // Mission CTAs
                    if (config.missions.cta) {
                        const element = document.getElementById('mission-cta');
                        if (element) element.textContent = config.missions.cta;
                    }
                    if (config.missions.mobileCta) {
                        const element = document.getElementById('mission-mobile-cta');
                        if (element) element.textContent = config.missions.mobileCta;
                    }
                }

                // Apply sponsors text
                if (config.sponsors) {
                    if (config.sponsors.title) {
                        const element = document.getElementById('sponsors-title');
                        if (element) element.textContent = config.sponsors.title;
                    }
                }

                // Apply contact form text
                if (config.contact) {
                    if (config.contact.title) {
                        const element = document.getElementById('contact-title');
                        if (element) element.textContent = config.contact.title;
                    }
                    if (config.contact.subtitle) {
                        const element = document.getElementById('contact-subtitle');
                        if (element) element.textContent = config.contact.subtitle;
                    }
                    
                    if (config.contact.form) {
                        const formMap = {
                            'form-name-label': config.contact.form.name?.label,
                            'form-email-label': config.contact.form.email?.label,
                            'form-phone-label': config.contact.form.phone?.label,
                            'form-company-label': config.contact.form.company?.label,
                            'form-reason-label': config.contact.form.reason?.label,
                            'form-message-label': config.contact.form.message?.label,
                            'form-submit': config.contact.form.submit
                        };
                        
                        Object.entries(formMap).forEach(([id, text]) => {
                            const element = document.getElementById(id);
                            if (element && text) {
                                element.textContent = text;
                            }
                        });
                        
                        // Update form placeholders
                        if (config.contact.form.name?.placeholder) {
                            const element = document.getElementById('contact-name');
                            if (element) element.placeholder = config.contact.form.name.placeholder;
                        }
                        if (config.contact.form.email?.placeholder) {
                            const element = document.getElementById('contact-email');
                            if (element) element.placeholder = config.contact.form.email.placeholder;
                        }
                        if (config.contact.form.phone?.placeholder) {
                            const element = document.getElementById('contact-phone');
                            if (element) element.placeholder = config.contact.form.phone.placeholder;
                        }
                        if (config.contact.form.company?.placeholder) {
                            const element = document.getElementById('contact-company');
                            if (element) element.placeholder = config.contact.form.company.placeholder;
                        }
                        if (config.contact.form.message?.placeholder) {
                            const element = document.getElementById('contact-message');
                            if (element) element.placeholder = config.contact.form.message.placeholder;
                        }
                    }
                }

                // Apply footer text
                if (config.footer) {
                    if (config.footer.contact) {
                        if (config.footer.contact.title) {
                            const element = document.getElementById('footer-contact-title');
                            if (element) element.textContent = config.footer.contact.title;
                        }
                        if (config.footer.contact.email) {
                            const element = document.getElementById('footer-email');
                            if (element) {
                                element.textContent = config.footer.contact.email;
                                element.href = `mailto:${config.footer.contact.email}`;
                            }
                        }
                        if (config.footer.contact.phone) {
                            const element = document.getElementById('footer-phone');
                            if (element) {
                                element.textContent = config.footer.contact.phone;
                                element.href = `tel:${config.footer.contact.phone}`;
                            }
                        }
                    }
                    
                    if (config.footer.address) {
                        if (config.footer.address.title) {
                            const element = document.getElementById('footer-address-title');
                            if (element) element.textContent = config.footer.address.title;
                        }
                        if (config.footer.address.content) {
                            const element = document.getElementById('footer-address');
                            if (element) element.innerHTML = config.footer.address.content;
                        }
                    }
                    
                    if (config.footer.socials?.title) {
                        const element = document.getElementById('footer-socials-title');
                        if (element) element.textContent = config.footer.socials.title;
                    }
                    
                    if (config.footer.bottom) {
                        if (config.footer.bottom.copyright) {
                            const element = document.getElementById('footer-copyright');
                            if (element) element.textContent = config.footer.bottom.copyright;
                        }
                        if (config.footer.bottom.designedBy && config.footer.bottom.designerName) {
                            const element = document.getElementById('footer-designed');
                            if (element) {
                                element.innerHTML = `${config.footer.bottom.designedBy} <a href="${config.footer.bottom.designerUrl || '#'}" target="_blank" rel="noopener noreferrer">${config.footer.bottom.designerName}</a>`;
                            }
                        }
                    }
                }

                // Apply font sizes from configuration
                if (config.fontSizes) {
                    const root = document.documentElement;
                    
                    // Navigation font sizes
                    if (config.fontSizes.navigation) {
                        if (config.fontSizes.navigation.navLinks) {
                            root.style.setProperty('--font-nav-links', config.fontSizes.navigation.navLinks);
                        }
                        if (config.fontSizes.navigation.backButton) {
                            root.style.setProperty('--font-back-button', config.fontSizes.navigation.backButton);
                        }
                        if (config.fontSizes.navigation.backButtonIcon) {
                            root.style.setProperty('--font-back-button-icon', config.fontSizes.navigation.backButtonIcon);
                        }
                    }
                    
                    // Hero section font sizes
                    if (config.fontSizes.hero) {
                        if (config.fontSizes.hero.title) {
                            root.style.setProperty('--font-hero-title', config.fontSizes.hero.title);
                        }
                        if (config.fontSizes.hero.description) {
                            root.style.setProperty('--font-hero-description', config.fontSizes.hero.description);
                        }
                    }
                    
                    // About section font sizes
                    if (config.fontSizes.about) {
                        if (config.fontSizes.about.title) {
                            root.style.setProperty('--font-about-title', config.fontSizes.about.title);
                        }
                        if (config.fontSizes.about.tagline) {
                            root.style.setProperty('--font-about-tagline', config.fontSizes.about.tagline);
                        }
                        if (config.fontSizes.about.subtitle) {
                            root.style.setProperty('--font-about-subtitle', config.fontSizes.about.subtitle);
                        }
                        if (config.fontSizes.about.content) {
                            root.style.setProperty('--font-about-content', config.fontSizes.about.content);
                        }
                    }
                    
                    // Mission section font sizes
                    if (config.fontSizes.missions) {
                        if (config.fontSizes.missions.title) {
                            root.style.setProperty('--font-mission-title', config.fontSizes.missions.title);
                        }
                        if (config.fontSizes.missions.subtitle) {
                            root.style.setProperty('--font-mission-subtitle', config.fontSizes.missions.subtitle);
                        }
                        if (config.fontSizes.missions.cta) {
                            root.style.setProperty('--font-mission-cta', config.fontSizes.missions.cta);
                        }
                        if (config.fontSizes.missions.mobileTitle) {
                            root.style.setProperty('--font-mission-mobile-title', config.fontSizes.missions.mobileTitle);
                        }
                        if (config.fontSizes.missions.mobileSubtitle) {
                            root.style.setProperty('--font-mission-mobile-subtitle', config.fontSizes.missions.mobileSubtitle);
                        }
                        if (config.fontSizes.missions.mobileCta) {
                            root.style.setProperty('--font-mission-mobile-cta', config.fontSizes.missions.mobileCta);
                        }
                    }
                    
                    // Sponsors section font sizes
                    if (config.fontSizes.sponsors) {
                        if (config.fontSizes.sponsors.title) {
                            root.style.setProperty('--font-sponsors-title', config.fontSizes.sponsors.title);
                        }
                    }
                    
                    // Contact section font sizes
                    if (config.fontSizes.contact) {
                        if (config.fontSizes.contact.title) {
                            root.style.setProperty('--font-contact-title', config.fontSizes.contact.title);
                        }
                        if (config.fontSizes.contact.subtitle) {
                            root.style.setProperty('--font-contact-subtitle', config.fontSizes.contact.subtitle);
                        }
                        if (config.fontSizes.contact.formLabel) {
                            root.style.setProperty('--font-form-label', config.fontSizes.contact.formLabel);
                        }
                        if (config.fontSizes.contact.formInput) {
                            root.style.setProperty('--font-form-input', config.fontSizes.contact.formInput);
                        }
                    }
                    
                    // Footer font sizes
                    if (config.fontSizes.footer) {
                        if (config.fontSizes.footer.sectionTitle) {
                            root.style.setProperty('--font-footer-section-title', config.fontSizes.footer.sectionTitle);
                        }
                        if (config.fontSizes.footer.content) {
                            root.style.setProperty('--font-footer-content', config.fontSizes.footer.content);
                        }
                    }
                    
                    // Mission detail page font sizes
                    if (config.fontSizes.missionDetail) {
                        if (config.fontSizes.missionDetail.header) {
                            root.style.setProperty('--font-mission-detail-header', config.fontSizes.missionDetail.header);
                        }
                        if (config.fontSizes.missionDetail.description) {
                            root.style.setProperty('--font-mission-detail-description', config.fontSizes.missionDetail.description);
                        }
                        if (config.fontSizes.missionDetail.sectionTitle) {
                            root.style.setProperty('--font-mission-detail-section-title', config.fontSizes.missionDetail.sectionTitle);
                        }
                        if (config.fontSizes.missionDetail.teamMemberName) {
                            root.style.setProperty('--font-team-member-name', config.fontSizes.missionDetail.teamMemberName);
                        }
                        if (config.fontSizes.missionDetail.teamMemberRole) {
                            root.style.setProperty('--font-team-member-role', config.fontSizes.missionDetail.teamMemberRole);
                        }
                        if (config.fontSizes.missionDetail.supportButton) {
                            root.style.setProperty('--font-support-button', config.fontSizes.missionDetail.supportButton);
                        }
                        if (config.fontSizes.missionDetail.galleryButton) {
                            root.style.setProperty('--font-gallery-button', config.fontSizes.missionDetail.galleryButton);
                        }
                    }
                    
                    // Mobile font sizes
                    if (config.fontSizes.mobile) {
                        if (config.fontSizes.mobile.heroTitle) {
                            root.style.setProperty('--font-mobile-hero-title', config.fontSizes.mobile.heroTitle);
                        }
                        if (config.fontSizes.mobile.heroDescription) {
                            root.style.setProperty('--font-mobile-hero-description', config.fontSizes.mobile.heroDescription);
                        }
                        if (config.fontSizes.mobile.missionTitle) {
                            root.style.setProperty('--font-mobile-mission-title', config.fontSizes.mobile.missionTitle);
                        }
                        if (config.fontSizes.mobile.missionSubtitle) {
                            root.style.setProperty('--font-mobile-mission-subtitle', config.fontSizes.mobile.missionSubtitle);
                        }
                        if (config.fontSizes.mobile.missionCta) {
                            root.style.setProperty('--font-mobile-mission-cta', config.fontSizes.mobile.missionCta);
                        }
                        if (config.fontSizes.mobile.slideshowTitle) {
                            root.style.setProperty('--font-mobile-slideshow-title', config.fontSizes.mobile.slideshowTitle);
                        }
                        if (config.fontSizes.mobile.slideshowDescription) {
                            root.style.setProperty('--font-mobile-slideshow-description', config.fontSizes.mobile.slideshowDescription);
                        }
                        if (config.fontSizes.mobile.missionDetailTitle) {
                            root.style.setProperty('--font-mobile-mission-detail-title', config.fontSizes.mobile.missionDetailTitle);
                        }
                    }
                    
                    // Lightbox and QR code font sizes
                    if (config.fontSizes.lightbox) {
                        if (config.fontSizes.lightbox.closeButton) {
                            root.style.setProperty('--font-lightbox-close', config.fontSizes.lightbox.closeButton);
                        }
                    }
                    if (config.fontSizes.qrCode) {
                        if (config.fontSizes.qrCode.description) {
                            root.style.setProperty('--font-qr-description', config.fontSizes.qrCode.description);
                        }
                    }
                    
                    if (config.settings && config.settings.showConsoleLogs) {
                        console.log('Font sizes applied from configuration');
                    }
                }

                if (config.settings && config.settings.showConsoleLogs) {
                    console.log('General configuration applied successfully');
                }

            } catch (error) {
                console.error('Error loading general configuration:', error);
            }
        }

        // Load social config immediately when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            loadSocialConfig();
            loadMissionCards(); // Load mission cards from general.json
        });

        // Load general configuration and sponsors when page loads
        window.addEventListener('load', () => {
            loadGeneralConfig();
            loadSponsors();
            loadQRConfig();
            loadCalendarConfig();
            initializeEmailJS();
            
            // Check for mission page on load (for refresh persistence)
            checkForMissionPageOnLoad();
        });

        // Make functions available globally for debugging/testing
        window.refreshSponsors = refreshSponsors;
        window.getSponsorsConfig = getSponsorsConfig;
        window.validateSponsorImage = validateSponsorImage;
        window.loadGeneralConfig = loadGeneralConfig;
        window.loadQRConfig = loadQRConfig;
        window.createQRCode = createQRCode;
        window.toggleQRPopup = toggleQRPopup;
        window.testEmailJS = testEmailJS;
        window.generateEmailContent = generateEmailContent;
        window.showConfettiPopup = showConfettiPopup;
        window.closeConfettiPopup = closeConfettiPopup;
        window.loadSocialConfig = loadSocialConfig;
        window.refreshSocialConfig = refreshSocialConfig;
        window.forceUpdateJoinButton = forceUpdateJoinButton;
        window.applySocialLinks = applySocialLinks;
        window.openWhatsApp = openWhatsApp;
        window.loadMissionImages = loadMissionImages;
        window.refreshMissionImages = refreshMissionImages;
        window.refreshAllMissionImages = refreshAllMissionImages;
        window.listMissionImages = listMissionImages;
        window.loadMissionCards = loadMissionCards;
        window.updateMissionCard = updateMissionCard;
        window.forceClearAllCache = forceClearAllCache;
        window.loadMissionSponsors = loadMissionSponsors;
        window.goToHomeAndContact = goToHomeAndContact;
        window.showMoreImages = showMoreImages;
        window.displayEmptyGallery = displayEmptyGallery;
        window.clearMissionCache = clearMissionCache;
        window.loadCalendarConfig = loadCalendarConfig;
        window.applyCalendarConfig = applyCalendarConfig;
        window.initializeCalendar = initializeCalendar;
        window.renderCalendar = renderCalendar;
        window.changeMonth = changeMonth;
        window.showEventPopup = showEventPopup;
        window.closeEventPopup = closeEventPopup;

        // Only scroll to top during boot animation, not on every page load
        // Removed automatic scroll-to-top events to allow free scrolling after boot animation

        // Mission Detail Page Functions
        async function openMission(missionNumber) {
            const mainWebsite = document.getElementById('main-website');
            const missionDetailPage = document.getElementById('mission-detail-page');
            const missionContent = document.getElementById('mission-content');
            
            // Update URL without reload
            const newUrl = window.location.pathname + '#mission' + missionNumber;
            window.history.pushState({ missionNumber }, '', newUrl);
            
            try {
                // Load mission config
                const response = await fetch(`mission${missionNumber}-config.json`);
                const config = await response.json();
                
                // Build mission content
                let html = `
                    <div class="mission-header">
                        <h1>${config.title}</h1>
                    </div>
                    
                    <div class="mission-description">
                        ${config.description}
                    </div>
                    
                    <!-- Meet the Team -->
                    <div class="mission-section">
                        <h2>MEET THE TEAM</h2>
                        <div class="team-grid">
                `;
                
                config.team.forEach(member => {
                    html += `
                        <div class="team-member">
                            <img src="${member.photo}" alt="${member.name}">
                            <h3>${member.name}</h3>
                            <p>${member.role}</p>
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                    
                    <!-- Images Gallery -->
                    <div class="mission-section">
                        <h2>IMAGES</h2>
                        <div class="images-grid" id="mission-gallery-${missionNumber}">
                            <!-- Dynamic images will be loaded here -->
                        </div>
                        <button class="expand-gallery-btn" id="see-more-btn-${missionNumber}" style="display: none;" onclick="showMoreImages(${missionNumber})">See More Photos</button>
                    </div>
                    
                    <!-- Sponsors -->
                    <section class="sponsor-section">
                        <div class="sponsor-inner">
                            <div class="sponsor-title">OUR MISSIONS ARE POSSIBLE THANKS TO OUR SPONSORS:</div>
                            <div class="sponsor-marquee">
                                <div class="sponsor-track" id="mission-sponsor-track-${missionNumber}">
                                    <!-- Dynamic sponsor content will be loaded here -->
                                </div>
                            </div>
                            <div class="sponsor-actions">
                                <button class="sponsor-support-btn" onclick="goToHomeAndContact('Sponsorship'); return false;">Support Our Missions</button>
                            </div>
                        </div>
                    </section>
                `;
                
                missionContent.innerHTML = html;
                
                // Load dynamic images for this mission (always force refresh)
                await loadMissionImages(missionNumber, true);
                
                // Load sponsors for this mission page
                await loadMissionSponsors(missionNumber);
                
            // Switch views
            mainWebsite.style.display = 'none';
            missionDetailPage.classList.add('active');
            updateBackButton();
                
                // Don't scroll to top - maintain current scroll position
                
            } catch (error) {
                console.error('Error loading mission config:', error);
                missionContent.innerHTML = `
                    <div class="mission-header">
                        <h1>Mission ${missionNumber}</h1>
                    </div>
                    <p style="color: #999; text-align: center; padding: 40px;">
                        Mission details coming soon! Please ensure mission${missionNumber}-config.json exists.
                    </p>
                `;
                
                // Switch views anyway
                mainWebsite.style.display = 'none';
                missionDetailPage.classList.add('active');
                // Don't scroll to top - maintain current scroll position
            }
        }

        // EmailJS Configuration
        const EMAILJS_CONFIG = {
            serviceId: 'service_dm4687d', // Your EmailJS service ID
            templateId: 'template_xwk0afi', // Your EmailJS template ID
            publicKey: '6wkZG3mn3LOsaa-Jo' // Your EmailJS public key
        };

        // Initialize EmailJS
        function initializeEmailJS() {
            if (typeof emailjs !== 'undefined') {
                emailjs.init(EMAILJS_CONFIG.publicKey);
                console.log('EmailJS initialized successfully');
            } else {
                console.error('EmailJS library not loaded');
            }
        }

        // Generate grammatically correct email content based on form data
        function generateEmailContent(formData) {
            const { name, email, phone, company, reason, message } = formData;
            
            // Create personalized greeting
            const firstName = name.split(' ')[0];
            
            // Generate interest-specific content based on reason
            let interestDescription = '';
            let personalizedMessage = '';
            
            switch (reason) {
                case 'General Inquiry':
                    interestDescription = 'learning more about AXA and our space missions';
                    personalizedMessage = 'We\'re excited to share more about our innovative CubeSat projects and the incredible work our team is doing in aerospace research.';
                    break;
                case 'Sponsorship':
                    interestDescription = 'sponsoring our space missions';
                    personalizedMessage = 'Your support is crucial to making our CubeSat launches possible. We\'d love to discuss partnership opportunities that align with your organization\'s goals.';
                    break;
                case 'Partnership':
                    interestDescription = 'forming a partnership with AXA';
                    personalizedMessage = 'We\'re always looking for innovative partners who share our vision of advancing space technology. Let\'s explore how we can work together.';
                    break;
                case 'Join the Team':
                    interestDescription = 'joining our team';
                    personalizedMessage = 'We\'re thrilled you\'re interested in becoming part of our mission! Our team is always looking for passionate individuals who want to contribute to space exploration.';
                    break;
                case 'Media':
                    interestDescription = 'media coverage of our missions';
                    personalizedMessage = 'We appreciate your interest in covering our groundbreaking work in space technology. We\'d be happy to provide you with press materials and arrange interviews.';
                    break;
                default:
                    interestDescription = 'connecting with AXA';
                    personalizedMessage = 'Thank you for reaching out to us. We\'re excited to learn more about how we can help you.';
            }
            
            return {
                name: name,
                firstName: firstName,
                email: email,
                phone: phone || 'Not provided',
                company: company || 'Not specified',
                interest: interestDescription,
                reason: reason,
                message: message || 'No additional message provided',
                personalizedMessage: personalizedMessage
            };
        }

        // Contact form handler with EmailJS integration
        async function handleContactSubmit(e) {
            e.preventDefault();
            
            // Get form data
            const formData = {
                name: document.getElementById('contact-name').value.trim(),
                email: document.getElementById('contact-email').value.trim(),
                phone: document.getElementById('contact-phone').value.trim(),
                company: document.getElementById('contact-company').value.trim(),
                reason: document.getElementById('contact-reason').value,
                message: document.getElementById('contact-message').value.trim()
            };
            
            // Validate required fields
            if (!formData.name || !formData.email || !formData.phone || !formData.reason || !formData.message) {
                alert('Please fill in all required fields (Name, Email, Phone, Reason for Contact, and Message).');
                return;
            }
            
            // Validate email format
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(formData.email)) {
                alert('Please enter a valid email address.');
                return;
            }
            
            // Show loading state
            const submitButton = document.getElementById('form-submit');
            const originalText = submitButton.textContent;
            submitButton.textContent = 'Sending...';
            submitButton.disabled = true;
            
            try {
                // Generate email content
                const emailContent = generateEmailContent(formData);
                
                // Check if EmailJS is properly configured
                if (EMAILJS_CONFIG.publicKey === 'YOUR_PUBLIC_KEY') {
                    throw new Error('EmailJS not configured. Please update the EMAILJS_CONFIG.publicKey with your actual EmailJS public key.');
                }
                
                // Send email using EmailJS
                const result = await emailjs.send(
                    EMAILJS_CONFIG.serviceId,
                    EMAILJS_CONFIG.templateId,
                    emailContent
                );
                
                console.log('Email sent successfully:', result);
                
                // Show confetti popup instead of alert
                showConfettiPopup(emailContent.firstName, formData.email);
                
                // Reset form
                document.querySelector('.contact-form').reset();
                
            } catch (error) {
                console.error('Error sending email:', error);
                
                // Show user-friendly error message
                let errorMessage = 'Sorry, there was an error sending your message. ';
                if (error.message.includes('not configured')) {
                    errorMessage += 'Please contact the website administrator.';
                } else {
                    errorMessage += 'Please try again or contact us directly at axa.fau@outlook.com.';
                }
                alert(errorMessage);
                
            } finally {
                // Reset button state
                submitButton.textContent = originalText;
                submitButton.disabled = false;
            }
        }

        // Test function for debugging EmailJS (available in browser console)
        async function testEmailJS() {
            console.log('Testing EmailJS configuration...');
            
            // Check if EmailJS is loaded
            if (typeof emailjs === 'undefined') {
                console.error('EmailJS library not loaded');
                return false;
            }
            
            // Check configuration
            if (EMAILJS_CONFIG.publicKey === 'YOUR_PUBLIC_KEY') {
                console.error('EmailJS not configured - please update EMAILJS_CONFIG.publicKey');
                return false;
            }
            
            console.log('EmailJS configuration looks good');
            console.log('Service ID:', EMAILJS_CONFIG.serviceId);
            console.log('Template ID:', EMAILJS_CONFIG.templateId);
            console.log('Public Key:', EMAILJS_CONFIG.publicKey);
            
            // Test with sample data
            const testData = {
                name: 'Test User',
                email: 'test@example.com',
                phone: '555-1234',
                company: 'Test Company',
                reason: 'General Inquiry',
                message: 'This is a test message'
            };
            
            const emailContent = generateEmailContent(testData);
            console.log('Generated email content:', emailContent);
            
            return true;
        }

        function goBackToMain() {
            const mainWebsite = document.getElementById('main-website');
            const missionDetailPage = document.getElementById('mission-detail-page');
            const backBtn = document.querySelector('.global-back-btn');
            
            // Switch views
            missionDetailPage.classList.remove('active');
            mainWebsite.style.display = 'block';
            
            // Hide back button immediately
            backBtn.style.display = 'none';
            
            // Update URL and history
            window.history.pushState(null, '', window.location.pathname);
            
            // Scroll to missions section
            const missionsSection = document.getElementById('missions');
            if (missionsSection) {
                const y = missionsSection.getBoundingClientRect().top + window.pageYOffset - 90;
                window.scrollTo({ top: y, behavior: 'smooth' });
            }
        }

        // Check for mission page on load (for refresh persistence)
        function checkForMissionPageOnLoad() {
            const hash = window.location.hash;
            if (hash && hash.startsWith('#mission')) {
                const missionNumber = parseInt(hash.replace('#mission', ''));
                if (missionNumber >= 1 && missionNumber <= 3) {
                    console.log(`Loading mission ${missionNumber} from URL hash`);
                    // Small delay to ensure all other load functions complete
                    setTimeout(() => {
                        openMission(missionNumber);
                    }, 100);
                }
            }
        }

        // Handle browser back/forward buttons
        window.addEventListener('popstate', (event) => {
            const mainWebsite = document.getElementById('main-website');
            const missionDetailPage = document.getElementById('mission-detail-page');
            
            if (event.state && event.state.missionNumber) {
                // Going to a mission page
                mainWebsite.style.display = 'none';
                missionDetailPage.classList.add('active');
                openMission(event.state.missionNumber);
            } else {
                // Going back to main
                missionDetailPage.classList.remove('active');
                mainWebsite.style.display = 'block';
                const missionsSection = document.getElementById('missions');
                if (missionsSection) {
                    const y = missionsSection.getBoundingClientRect().top + window.pageYOffset - 90;
                    window.scrollTo({ top: y, behavior: 'smooth' });
                }
            }
        });

        function openLightbox(imgSrc) {
            const lightbox = document.getElementById('lightbox');
            const lightboxImg = document.getElementById('lightbox-img');
            lightboxImg.src = imgSrc;
            lightbox.classList.add('active');
        }

        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            lightbox.classList.remove('active');
        }

        // Close lightbox on escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeLightbox();
                const qrPopup = document.getElementById('qr-popup');
                if (qrPopup.classList.contains('active')) {
                    toggleQRPopup();
                }
                const eventPopup = document.getElementById('event-popup');
                if (eventPopup.classList.contains('active')) {
                    closeEventPopup();
                }
            }
        });

        // Mobile Menu Toggle
        function toggleMobileMenu() {
            const navLinks = document.querySelector('.nav-links');
            const menuToggle = document.querySelector('.menu-toggle');
            navLinks.classList.toggle('active');
            menuToggle.classList.toggle('active');
        }

        // Close mobile menu when clicking a link
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', () => {
                const navLinks = document.querySelector('.nav-links');
                const menuToggle = document.querySelector('.menu-toggle');
                if (navLinks.classList.contains('active')) {
                    navLinks.classList.remove('active');
                    menuToggle.classList.remove('active');
                }
                // If it's the home link and we're on a mission page, go home
                if (link.textContent === 'Home' && document.getElementById('mission-detail-page').classList.contains('active')) {
                    goToHome();
                    return false;
                }
            });
        });

        // QR Code functionality with dynamic generator
        let qrCode = null;
        let qrConfig = null;
        
        // Load QR configuration from general.json
        async function loadQRConfig() {
            try {
                const response = await fetch('general.json');
                const config = await response.json();
                qrConfig = config.qrCode || {};
                
                // Set default values if not provided
                qrConfig = {
                    data: qrConfig.data || window.location.href,
                    width: qrConfig.width || 256,
                    height: qrConfig.height || 256,
                    margin: qrConfig.margin || 12,
                    background: {
                        color: qrConfig.background?.color || '#ffffff',
                        transparent: qrConfig.background?.transparent || false
                    },
                    dots: {
                        type: qrConfig.dots?.type || 'rounded',
                        color: qrConfig.dots?.color || '#00008f'
                    },
                    cornersSquare: {
                        type: qrConfig.cornersSquare?.type || 'square',
                        color: qrConfig.cornersSquare?.color || '#00008f'
                    },
                    cornersDot: {
                        type: qrConfig.cornersDot?.type || 'dot',
                        color: qrConfig.cornersDot?.color || '#00008f'
                    },
                    logo: {
                        enabled: qrConfig.logo?.enabled || false,
                        src: qrConfig.logo?.src || '',
                        size: qrConfig.logo?.size || 0.25,
                        margin: qrConfig.logo?.margin || 6
                    }
                };
                
                if (config.settings && config.settings.showConsoleLogs) {
                    console.log('QR configuration loaded:', qrConfig);
                }
            } catch (error) {
                console.error('Error loading QR configuration:', error);
                // Use fallback configuration
                qrConfig = {
                    data: window.location.href,
                    width: 256,
                    height: 256,
                    margin: 12,
                    background: { color: '#ffffff', transparent: false },
                    dots: { type: 'rounded', color: '#00008f' },
                    cornersSquare: { type: 'square', color: '#00008f' },
                    cornersDot: { type: 'dot', color: '#00008f' },
                    logo: { enabled: false, src: '', size: 0.25, margin: 6 }
                };
            }
        }
        
        function createQRCode() {
            if (!qrConfig) {
                console.warn('QR config not loaded, using defaults');
                qrConfig = {
                    data: window.location.href,
                    width: 256,
                    height: 256,
                    margin: 12,
                    background: { color: '#ffffff', transparent: false },
                    dots: { type: 'rounded', color: '#00008f' },
                    cornersSquare: { type: 'square', color: '#00008f' },
                    cornersDot: { type: 'dot', color: '#00008f' },
                    logo: { enabled: false, src: '', size: 0.25, margin: 6 }
                };
            }
            
            const qrContainer = document.getElementById('qr-code');
            if (!qrContainer) {
                console.error('QR container not found');
                return;
            }
            
            qrContainer.innerHTML = ''; // Clear previous QR code
            
            try {
                // Create QR code with dynamic styling
                const qrOptions = {
                    width: qrConfig.width || 256,
                    height: qrConfig.height || 256,
                    data: qrConfig.data || window.location.href,
                    margin: qrConfig.margin || 12,
                    type: 'svg',
                    backgroundOptions: {
                        color: qrConfig.background?.transparent ? 'transparent' : (qrConfig.background?.color || '#ffffff')
                    },
                    dotsOptions: {
                        type: qrConfig.dots?.type || 'rounded',
                        color: qrConfig.dots?.color || '#00008f'
                    },
                    cornersSquareOptions: {
                        type: qrConfig.cornersSquare?.type || 'square',
                        color: qrConfig.cornersSquare?.color || '#00008f'
                    },
                    cornersDotOptions: {
                        type: qrConfig.cornersDot?.type || 'dot',
                        color: qrConfig.cornersDot?.color || '#00008f'
                    }
                };
                
                // Only add image options if logo is enabled and has a valid source
                if (qrConfig.logo?.enabled && qrConfig.logo?.src) {
                    qrOptions.imageOptions = {
                        crossOrigin: 'anonymous',
                        margin: qrConfig.logo.margin || 6,
                        imageSize: qrConfig.logo.size || 0.25,
                        hideBackgroundDots: false
                    };
                    qrOptions.image = qrConfig.logo.src;
                }
                
                qrCode = new QRCodeStyling(qrOptions);
                qrCode.append(qrContainer);
                
                console.log('QR code created successfully');
            } catch (error) {
                console.error('Error creating QR code:', error);
                // Fallback: create a simple text message
                qrContainer.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">QR Code generation failed. Please check configuration.</p>';
            }
        }
        
        function toggleQRPopup() {
            const popup = document.getElementById('qr-popup');
            popup.classList.toggle('active');
            
            if (popup.classList.contains('active') && !qrCode) {
                // Initialize QR code on first open
                createQRCode();
            }
        }

        // Confetti Popup Functions
        function showConfettiPopup(firstName, email) {
            const popup = document.getElementById('confetti-popup');
            const message = document.getElementById('confetti-message');
            
            // Update message with personalized content
            message.textContent = `Thank you, ${firstName}! We've sent a confirmation email to ${email}. We'll get back to you soon!`;
            
            // Show popup
            popup.classList.add('active');
            
            // Create confetti animation
            createConfetti();
        }

        function closeConfettiPopup() {
            const popup = document.getElementById('confetti-popup');
            popup.classList.remove('active');
            
            // Clear confetti
            const existingConfetti = document.querySelectorAll('.confetti');
            existingConfetti.forEach(confetti => confetti.remove());
        }

        function createConfetti() {
            const popup = document.getElementById('confetti-popup');
            
            // Create multiple confetti pieces
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.top = '-10px'; // Start from top of screen
                confetti.style.animationDelay = Math.random() * 3 + 's';
                confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                popup.appendChild(confetti);
            }
        }
    </script>
</body>
</html>

